<Activity mc:Ignorable="sap sap2010" x:Class="Main" mva:VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="1083,827" sap2010:WorkflowViewState.IdRef="ActivityBuilder_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:uascw="clr-namespace:UiPath.Activities.System.Compression.Workflow;assembly=UiPath.System.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="46">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.SMTP.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>UiPath.Core.Activities.Orchestrator</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>UiPath.DataTableUtilities</x:String>
      <x:String>UiPath.UIAutomationNext.Enums</x:String>
      <x:String>UiPath.UIAutomationNext.Activities</x:String>
      <x:String>UiPath.Platform.ObjectLibrary</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>UiPath.Database.Activities</x:String>
      <x:String>UiPath.Mail.Outlook.Activities</x:String>
      <x:String>UiPath.Activities.System.Compression.Zip</x:String>
      <x:String>UiPath.Activities.System.Encode</x:String>
      <x:String>UiPath.Activities.System.Compression.Workflow</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="74">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>UiPath.Database.Activities</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="Main" sap:VirtualizedContainerService.HintSize="780,728" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="s:Exception" Name="SystemException" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Name="Config" />
      <Variable x:TypeArguments="scg:List(x:String)" Name="QueuenameList" />
      <Variable x:TypeArguments="x:Int32" Default="0" Name="Runtime" />
      <Variable x:TypeArguments="ui:QueueItem" Name="RunningWorklistTransaction" />
      <Variable x:TypeArguments="x:String" Name="WorkingCarrierName" />
      <Variable x:TypeArguments="sd:DataTable" Name="WorkingDT" />
      <Variable x:TypeArguments="x:String" Name="BusinessException" />
      <Variable x:TypeArguments="x:Int32" Name="ErrorRowCounter" />
      <Variable x:TypeArguments="x:String" Name="SQLConnectionString" />
      <Variable x:TypeArguments="x:String" Name="RootTempFolder" />
      <Variable x:TypeArguments="x:String" Name="RunningTempfolder" />
      <Variable x:TypeArguments="x:String" Name="RunningTempDTpath" />
      <Variable x:TypeArguments="x:String" Name="RPATechnicalSupportEmail" />
      <Variable x:TypeArguments="x:String" Name="SuccessScreenShotFolder" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <StateMachine InitialState="{x:Reference __ReferenceID25}" DisplayName="State Machine" sap:VirtualizedContainerService.HintSize="738,636" sap2010:WorkflowViewState.IdRef="StateMachine_1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <av:Point x:Key="ShapeLocation">10,2.5</av:Point>
          <x:Double x:Key="StateContainerWidth">704</x:Double>
          <x:Double x:Key="StateContainerHeight">600</x:Double>
          <av:PointCollection x:Key="ConnectorLocation">70,28.75 430,28.75 430,67.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State x:Name="__ReferenceID14" DisplayName="Transaction" sap:VirtualizedContainerService.HintSize="253,125" sap2010:WorkflowViewState.IdRef="State_2">
        <State.Entry>
          <Sequence DisplayName="Get Need To Processing Data" sap:VirtualizedContainerService.HintSize="1186,1127" sap2010:WorkflowViewState.IdRef="Sequence_7">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Flowchart sap:VirtualizedContainerService.HintSize="1144,944" sap2010:WorkflowViewState.IdRef="Flowchart_2">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">490,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">520,77.5 520,106.5</av:PointCollection>
                  <x:Double x:Key="Width">1110.5</x:Double>
                  <x:Double x:Key="Height">908.5</x:Double>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID13</x:Reference>
              </Flowchart.StartNode>
              <FlowDecision x:Name="__ReferenceID13" Condition="[Runtime=1]" DisplayName="Runtime=1?" sap:VirtualizedContainerService.HintSize="75,87" sap2010:WorkflowViewState.IdRef="FlowDecision_4">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <av:Point x:Key="ShapeLocation">482.5,106.5</av:Point>
                    <av:Size x:Key="ShapeSize">75,87</av:Size>
                    <av:PointCollection x:Key="FalseConnector">557.5,150 810,150 810,196.5</av:PointCollection>
                    <av:PointCollection x:Key="TrueConnector">482.5,150 320,150 320,181</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <FlowDecision.True>
                  <FlowStep x:Name="__ReferenceID7">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">220,181</av:Point>
                        <av:Size x:Key="ShapeSize">200,138</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">320,319 320,366.5</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Sequence sap2010:Annotation.AnnotationText="取得需運行Carrier Name&#xA;測試用_(需刪除)Crrier_自行設定&#xA;Log" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="Sequence_134">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="取得需運行Carrier Name" DisplayName="Invoke GetRunningCarrierQueueName workflow" sap:VirtualizedContainerService.HintSize="436,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_104" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\GetRunningCarrierQueueName.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_WorkingCarriername">[WorkingCarrierName]</OutArgument>
                          <OutArgument x:TypeArguments="ui:QueueItem" x:Key="out_RunningWorklistTransaction">[RunningWorklistTransaction]</OutArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:InvokeWorkflowFile>
                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="436,272" sap2010:WorkflowViewState.IdRef="CommentOut_62">
                        <ui:CommentOut.Body>
                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="305,194" sap2010:WorkflowViewState.IdRef="Sequence_241">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign sap2010:Annotation.AnnotationText="測試用_需刪除Crrier_自定義&#xA;" DisplayName="測試用_Assign" sap:VirtualizedContainerService.HintSize="263,102" sap2010:WorkflowViewState.IdRef="Assign_185">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[WorkingCarrierName]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">CHNL</InArgument>
                              </Assign.Value>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </Assign>
                          </Sequence>
                        </ui:CommentOut.Body>
                      </ui:CommentOut>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="436,91" sap2010:WorkflowViewState.IdRef="LogMessage_73" Level="Info" Message="[&quot;Running Crrier Name：&quot;+WorkingCarrierName]" />
                    </Sequence>
                    <FlowStep.Next>
                      <FlowDecision x:Name="__ReferenceID8" Condition="[WorkingCarrierName is Nothing]" DisplayName="WorkingCarrierName is Nothing" sap:VirtualizedContainerService.HintSize="160,87" sap2010:WorkflowViewState.IdRef="FlowDecision_10">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <av:Point x:Key="ShapeLocation">240,366.5</av:Point>
                            <av:Size x:Key="ShapeSize">160,87</av:Size>
                            <av:PointCollection x:Key="TrueConnector">240,410 140,410 140,500</av:PointCollection>
                            <av:PointCollection x:Key="FalseConnector">400,410 430,410 430,496</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <FlowDecision.True>
                          <FlowStep x:Name="__ReferenceID9">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <av:Point x:Key="ShapeLocation">8.5,500</av:Point>
                                <av:Size x:Key="ShapeSize">263,91</av:Size>
                                <av:PointCollection x:Key="ConnectorLocation">140,591 140,631.76 290,631.76 290,656.5</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign sap2010:Annotation.AnnotationText="設定No carrier is found" DisplayName="RunningWorklistTransaction is nothing_Assign" sap:VirtualizedContainerService.HintSize="263,91" sap2010:WorkflowViewState.IdRef="Assign_187">
                              <Assign.To>
                                <OutArgument x:TypeArguments="ui:QueueItem">[RunningWorklistTransaction]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="ui:QueueItem">[Nothing]</InArgument>
                              </Assign.Value>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </Assign>
                            <FlowStep.Next>
                              <FlowDecision x:Name="__ReferenceID0" Condition="[WorkingDT.Rows.Count&gt;0]" DisplayName="WorkingDT.Rows.Count&gt;0" sap:VirtualizedContainerService.HintSize="156,87" sap2010:WorkflowViewState.IdRef="FlowDecision_11">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <av:Point x:Key="ShapeLocation">212,656.5</av:Point>
                                    <av:Size x:Key="ShapeSize">156,87</av:Size>
                                    <av:PointCollection x:Key="FalseConnector">368,700 470,700 470,791.5</av:PointCollection>
                                    <av:PointCollection x:Key="TrueConnector">212,700 150,700 150,791.5</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <FlowDecision.True>
                                  <FlowStep x:Name="__ReferenceID12">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <av:Point x:Key="ShapeLocation">50,791.5</av:Point>
                                        <av:Size x:Key="ShapeSize">200,97</av:Size>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence sap2010:Annotation.AnnotationText="執行流程_開始抓取資料" DisplayName="Go Process_Sequecne" sap:VirtualizedContainerService.HintSize="200,97" sap2010:WorkflowViewState.IdRef="Sequence_141">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="BusinessException_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_189">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">Need to run process</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:LogMessage DisplayName="&quot;Need to run process&quot;_Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_76" Level="Warn" Message="[&quot;Run time：&quot;+Runtime.ToString+BusinessException]" />
                                    </Sequence>
                                  </FlowStep>
                                </FlowDecision.True>
                                <FlowDecision.False>
                                  <FlowStep x:Name="__ReferenceID11">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <av:Point x:Key="ShapeLocation">370,791.5</av:Point>
                                        <av:Size x:Key="ShapeSize">200,97</av:Size>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence sap2010:Annotation.AnnotationText="結束流程_無資料需運行" DisplayName="Go End Process_Sequecne" sap:VirtualizedContainerService.HintSize="200,97" sap2010:WorkflowViewState.IdRef="Sequence_140">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_188">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_75" Level="Warn" Message="[&quot;Runtime：&quot;+ Runtime.ToString+&quot; BusinessException is nothing and No data need to be exctracted&quot;]" />
                                    </Sequence>
                                  </FlowStep>
                                </FlowDecision.False>
                              </FlowDecision>
                            </FlowStep.Next>
                          </FlowStep>
                        </FlowDecision.True>
                        <FlowDecision.False>
                          <FlowStep x:Name="__ReferenceID10">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <av:Point x:Key="ShapeLocation">330,496</av:Point>
                                <av:Size x:Key="ShapeSize">200,108</av:Size>
                                <av:PointCollection x:Key="ConnectorLocation">430,604 430,634 290,634 290,656.5</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Sequence sap2010:Annotation.AnnotationText="Init Tempt Folder&#xA;取得本次需運行筆數與資料" DisplayName="InitTemp Folder and WorkListDT" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="Sequence_139">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke InitIalize WorkingTempFolder and XLSX workflow" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_109" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\InitIalize WorkingTempFolder and XLSX.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                                  <OutArgument x:TypeArguments="x:String" x:Key="out_Workingtempfolder">[RunningTempfolder]</OutArgument>
                                  <OutArgument x:TypeArguments="x:String" x:Key="out_WorkingtempXLSX">[RunningTempDTpath]</OutArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Roottempfolder">[RootTempFolder]</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_WorkingcarrierName">[WorkingCarrierName]</InArgument>
                                  <OutArgument x:TypeArguments="x:String" x:Key="out_SuccessScreenShotFolder">[SuccessScreenShotFolder]</OutArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="379,91" sap2010:WorkflowViewState.IdRef="LogMessage_91" Level="Warn" Message="[SuccessScreenShotFolder]" />
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="創建Worklist(Carrier內需運行總筆數與資料)" DisplayName="Invoke GetCarrierTransactions workflow" sap:VirtualizedContainerService.HintSize="379,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_110" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\GetCarrierTransactions.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_WorkingCarriername">[WorkingCarrierName]</InArgument>
                                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_WorkingDT">[WorkingDT]</OutArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:InvokeWorkflowFile>
                            </Sequence>
                            <FlowStep.Next>
                              <x:Reference>__ReferenceID0</x:Reference>
                            </FlowStep.Next>
                          </FlowStep>
                        </FlowDecision.False>
                      </FlowDecision>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowDecision.True>
                <FlowDecision.False>
                  <FlowDecision x:Name="__ReferenceID1" Condition="[not Runtime&gt;3]" DisplayName="not Runtime&gt;3" sap:VirtualizedContainerService.HintSize="91,87" sap2010:WorkflowViewState.IdRef="FlowDecision_5">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <av:Point x:Key="ShapeLocation">764,196.5</av:Point>
                        <av:Size x:Key="ShapeSize">91,87</av:Size>
                        <av:PointCollection x:Key="FalseConnector">856,240 900,240 900,311.5</av:PointCollection>
                        <av:PointCollection x:Key="TrueConnector">764,240 670,240 670,307</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <FlowDecision.True>
                      <FlowStep x:Name="__ReferenceID4">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">570,307</av:Point>
                            <av:Size x:Key="ShapeSize">200,66</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">670,373 670,403 770,403 770,436.5</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Sequence DisplayName="Count Error Rows" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_130">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign DisplayName="ErroeRowCounter_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_182">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Int32">[ErrorRowCounter]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Int32">[WorkingDT.AsEnumerable().Where(Function(row) row(“status”).ToString.Contains("Crush”)).ToArray().Count]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_70" Level="Warn" Message="[&quot;ErrorRowCounter is &quot;+ErrorRowCounter.tostring+&quot; Go check if need to retry&quot;]" />
                        </Sequence>
                        <FlowStep.Next>
                          <FlowDecision x:Name="__ReferenceID3" Condition="[ErrorRowCounter=0]" DisplayName="ErroeRowCounter=0?" sap:VirtualizedContainerService.HintSize="128,87" sap2010:WorkflowViewState.IdRef="FlowDecision_9">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <av:Point x:Key="ShapeLocation">706,436.5</av:Point>
                                <av:Size x:Key="ShapeSize">128,87</av:Size>
                                <av:PointCollection x:Key="FalseConnector">834,480 890,480 890,587</av:PointCollection>
                                <av:PointCollection x:Key="TrueConnector">706,480 660,480 660,587</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <FlowDecision.True>
                              <FlowStep x:Name="__ReferenceID6">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">560,587</av:Point>
                                    <av:Size x:Key="ShapeSize">200,66</av:Size>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Sequence DisplayName="Go End Process_Sequence" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_132">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_184">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_72" Level="Warn" Message="[&quot;Retry finished at runtime_&quot;+ (Runtime-1).ToString]" />
                                </Sequence>
                              </FlowStep>
                            </FlowDecision.True>
                            <FlowDecision.False>
                              <FlowStep x:Name="__ReferenceID5">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">790,587</av:Point>
                                    <av:Size x:Key="ShapeSize">200,66</av:Size>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Sequence DisplayName="Go process_Sequence" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_131">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign DisplayName="BusinessException_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_183">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">Need Retry</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_71" Level="Warn" Message="[&quot;Runtime：&quot;+ Runtime.ToString+&quot;BusinessException_&quot;+BusinessException]" />
                                </Sequence>
                              </FlowStep>
                            </FlowDecision.False>
                          </FlowDecision>
                        </FlowStep.Next>
                      </FlowStep>
                    </FlowDecision.True>
                    <FlowDecision.False>
                      <FlowStep x:Name="__ReferenceID2">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">800,311.5</av:Point>
                            <av:Size x:Key="ShapeSize">200,97</av:Size>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Sequence sap2010:Annotation.AnnotationText="out limit" DisplayName="Go End process_Sequence" sap:VirtualizedContainerService.HintSize="200,97" sap2010:WorkflowViewState.IdRef="Sequence_104">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_178">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_55" Level="Warn" Message="[&quot;Retry time is&quot;+ (Runtime-1).ToString+&quot;  and out of Retry limit, Go End Process&quot;]" />
                        </Sequence>
                      </FlowStep>
                    </FlowDecision.False>
                  </FlowDecision>
                </FlowDecision.False>
              </FlowDecision>
              <x:Reference>__ReferenceID1</x:Reference>
              <x:Reference>__ReferenceID2</x:Reference>
              <x:Reference>__ReferenceID3</x:Reference>
              <x:Reference>__ReferenceID4</x:Reference>
              <x:Reference>__ReferenceID5</x:Reference>
              <x:Reference>__ReferenceID6</x:Reference>
              <x:Reference>__ReferenceID7</x:Reference>
              <x:Reference>__ReferenceID8</x:Reference>
              <x:Reference>__ReferenceID9</x:Reference>
              <x:Reference>__ReferenceID10</x:Reference>
              <x:Reference>__ReferenceID0</x:Reference>
              <x:Reference>__ReferenceID11</x:Reference>
              <x:Reference>__ReferenceID12</x:Reference>
            </Flowchart>
            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1144,51" sap2010:WorkflowViewState.IdRef="CommentOut_15">
              <ui:CommentOut.Body>
                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="2228,1966" sap2010:WorkflowViewState.IdRef="Sequence_142">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If Condition="[Runtime=1]" sap:VirtualizedContainerService.HintSize="2186,1874" sap2010:WorkflowViewState.IdRef="If_18">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Then>
                      <Sequence sap:VirtualizedContainerService.HintSize="839,1717" sap2010:WorkflowViewState.IdRef="Sequence_50">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="取得需運行Carrier Name" DisplayName="Invoke GetRunningCarrierQueueName workflow" sap:VirtualizedContainerService.HintSize="797,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_15" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\GetRunningCarrierQueueName.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                            <OutArgument x:TypeArguments="x:String" x:Key="out_WorkingCarriername">[WorkingCarrierName]</OutArgument>
                            <OutArgument x:TypeArguments="ui:QueueItem" x:Key="out_RunningWorklistTransaction">[RunningWorklistTransaction]</OutArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InvokeWorkflowFile>
                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="797,51" sap2010:WorkflowViewState.IdRef="CommentOut_11">
                          <ui:CommentOut.Body>
                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="305,194" sap2010:WorkflowViewState.IdRef="Sequence_129">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap2010:Annotation.AnnotationText="測試用_需刪除Crrier_CHNL&#xA;" DisplayName="測試用_Assign" sap:VirtualizedContainerService.HintSize="263,102" sap2010:WorkflowViewState.IdRef="Assign_160">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[WorkingCarrierName]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">EGLV</InArgument>
                                </Assign.Value>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </Assign>
                            </Sequence>
                          </ui:CommentOut.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:CommentOut>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke InitIalize WorkingTempFolder and XLSX workflow" sap:VirtualizedContainerService.HintSize="797,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_92" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\InitIalize WorkingTempFolder and XLSX.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                            <OutArgument x:TypeArguments="x:String" x:Key="out_Workingtempfolder">[RunningTempfolder]</OutArgument>
                            <OutArgument x:TypeArguments="x:String" x:Key="out_WorkingtempXLSX">[RunningTempDTpath]</OutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_Roottempfolder">[RootTempFolder]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_WorkingcarrierName">[WorkingCarrierName]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke InitIalize WorkingTempFolder and XLSX workflow" sap:VirtualizedContainerService.HintSize="797,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_108" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\InitIalize WorkingTempFolder and XLSX.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[Config]</InArgument>
                            <OutArgument x:TypeArguments="x:String" x:Key="out_Workingtempfolder">[RunningTempfolder]</OutArgument>
                            <OutArgument x:TypeArguments="x:String" x:Key="out_WorkingtempXLSX">[RunningTempDTpath]</OutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_Roottempfolder">[RootTempFolder]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="in_WorkingcarrierName">[WorkingCarrierName]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="797,91" sap2010:WorkflowViewState.IdRef="LogMessage_57" Level="Info" Message="[&quot;Running Crrier Name：&quot;+WorkingCarrierName]" />
                        <If sap2010:Annotation.AnnotationText="WorkingCarrierName.Length&lt;1，並無Carrier需要運行&#xA;WorkingCarrierName.Length&gt;1，取得Carrier成功，確認是否需要執行資料抓取" Condition="[WorkingCarrierName is Nothing]" DisplayName="確認是否取得Carrier Name_If" sap:VirtualizedContainerService.HintSize="797,435" sap2010:WorkflowViewState.IdRef="If_23">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If.Then>
                            <Assign DisplayName="RunningWorklistTransaction is nothing_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_159">
                              <Assign.To>
                                <OutArgument x:TypeArguments="ui:QueueItem">[RunningWorklistTransaction]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="ui:QueueItem">[Nothing]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </If.Then>
                          <If.Else>
                            <Sequence sap:VirtualizedContainerService.HintSize="376,235" sap2010:WorkflowViewState.IdRef="Sequence_138">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="創建Worklist(Carrier內需運行總筆數與資料)" DisplayName="Invoke GetCarrierTransactions workflow" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_16" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\GetCarrierTransactions.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_WorkingCarriername">[WorkingCarrierName]</InArgument>
                                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_WorkingDT">[WorkingDT]</OutArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:InvokeWorkflowFile>
                            </Sequence>
                          </If.Else>
                        </If>
                        <If Condition="[WorkingDT.Rows.Count&gt;0]" DisplayName="if go process_If" sap:VirtualizedContainerService.HintSize="797,441" sap2010:WorkflowViewState.IdRef="If_15">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_57">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="BusinessException_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_66">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">Need to run process</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="&quot;Need to run process&quot;_Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_12" Level="Warn" Message="[&quot;Run time：&quot;+Runtime.ToString+BusinessException]" />
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Sequence sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_58">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_67">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_13" Level="Warn" Message="[&quot;Runtime：&quot;+ Runtime.ToString+&quot; BusinessException is nothing and No data need to be exctracted&quot;]" />
                            </Sequence>
                          </If.Else>
                        </If>
                      </Sequence>
                    </If.Then>
                    <If.Else>
                      <Sequence DisplayName="Use 處理一下的workdt_Sequence" sap:VirtualizedContainerService.HintSize="1302,1055" sap2010:WorkflowViewState.IdRef="Sequence_55">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If sap2010:Annotation.AnnotationText="Runtime&gt;3_結束流程&#xA;Runtime&lt;=3_確認是否存在Cursh data，存在則go process，不存在則End process" Condition="[not Runtime&gt;3]" sap:VirtualizedContainerService.HintSize="1260,963" sap2010:WorkflowViewState.IdRef="If_17">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="839,764" sap2010:WorkflowViewState.IdRef="Sequence_53">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="ErroeRowCounter_Assign" sap:VirtualizedContainerService.HintSize="797,60" sap2010:WorkflowViewState.IdRef="Assign_68">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[ErroeRowCounter]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[WorkingDT.AsEnumerable().Where(Function(row) row(“status”).ToString.Contains("Crush”)).ToArray().Count]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="797,91" sap2010:WorkflowViewState.IdRef="LogMessage_37" Level="Warn" Message="[&quot;ErroeRowCounter is &quot;+ErroeRowCounter.tostring+&quot; Go check if need to retry&quot;]" />
                              <If Condition="[ErroeRowCounter=0]" sap:VirtualizedContainerService.HintSize="797,441" sap2010:WorkflowViewState.IdRef="If_16">
                                <If.Then>
                                  <Sequence DisplayName="Go End Process_Sequence" sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_52">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_73">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_15" Level="Warn" Message="[&quot;Retry finished at runtime_&quot;+ (Runtime-1).ToString]" />
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <Sequence DisplayName="Go process_Sequence" sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_51">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign DisplayName="BusinessException_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_69">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">Need Retry</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_14" Level="Warn" Message="[&quot;Runtime：&quot;+ Runtime.ToString+&quot;BusinessException_&quot;+BusinessException]" />
                                  </Sequence>
                                </If.Else>
                              </If>
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Sequence DisplayName="Go End process_Sequence" sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_54">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_74">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_16" Level="Warn" Message="[&quot;Retry time is&quot;+ (Runtime-1).ToString+&quot;  and out of Retry limit, Go End Process&quot;]" />
                            </Sequence>
                          </If.Else>
                        </If>
                      </Sequence>
                    </If.Else>
                  </If>
                </Sequence>
              </ui:CommentOut.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:CommentOut>
          </Sequence>
        </State.Entry>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">303.5,247.5</av:Point>
            <av:Size x:Key="ShapeSize">253,125</av:Size>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <x:Double x:Key="StateContainerWidth">219</x:Double>
            <x:Double x:Key="StateContainerHeight">88.519999999999982</x:Double>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <State.Transitions>
          <Transition DisplayName="Go Processing" sap:VirtualizedContainerService.HintSize="479,578" sap2010:WorkflowViewState.IdRef="Transition_4">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">430,372.5 430,427.5</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <State x:Name="__ReferenceID24" DisplayName="Processing" sap:VirtualizedContainerService.HintSize="1547,9276" sap2010:WorkflowViewState.IdRef="State_5">
                <State.Entry>
                  <Sequence DisplayName="Process_sequence" sap:VirtualizedContainerService.HintSize="1501,8862" sap2010:WorkflowViewState.IdRef="Sequence_22">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="x:Int32" Name="RowCounter" />
                      <Variable x:TypeArguments="sd:DataTable" Name="PortNameMappingDatatable" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch DisplayName="資料抓取前設定_Try Catch" sap:VirtualizedContainerService.HintSize="1459,2717" sap2010:WorkflowViewState.IdRef="TryCatch_16">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <Sequence DisplayName="資料抓取前設定_Sequence" sap:VirtualizedContainerService.HintSize="644,2490" sap2010:WorkflowViewState.IdRef="Sequence_82">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:SendHotkey ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SpecialKey="{x:Null}" Activate="True" DisplayName="Send Hotkey" sap:VirtualizedContainerService.HintSize="602,116" sap2010:WorkflowViewState.IdRef="SendHotkey_1" Key="0" KeyModifiers="Ctrl">
                            <ui:SendHotkey.Target>
                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="b4ca0803-526b-48a6-a0d2-acd56e59b49a">
                                <ui:Target.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:Target.TimeoutMS>
                                <ui:Target.WaitForReady>
                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                </ui:Target.WaitForReady>
                              </ui:Target>
                            </ui:SendHotkey.Target>
                          </ui:SendHotkey>
                          <ui:LogMessage DisplayName="開始Processing_Log Message" sap:VirtualizedContainerService.HintSize="602,91" sap2010:WorkflowViewState.IdRef="LogMessage_19" Level="Info" Message="[&quot;開始Processing....&quot;]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                          <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="602,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
                            <ui:MultipleAssign.AssignOperations>
                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="x:Int32">[RowCounter]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="sd:DataTable">[PortNameMappingDatatable]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="sd:DataTable">[new DataTable]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_19">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="scg:List(x:String)">[PortNameMappingDatatablelist]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="scg:List(x:String)">[new List(of string)]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                              </scg:List>
                            </ui:MultipleAssign.AssignOperations>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:MultipleAssign>
                          <Sequence DisplayName="取得代號與港口對應表_Sequence" sap:VirtualizedContainerService.HintSize="602,1263" sap2010:WorkflowViewState.IdRef="Sequence_62">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="ui:DatabaseConnection" Name="DatabaseConnection1" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="560,91" sap2010:WorkflowViewState.IdRef="LogMessage_58" Level="Info" Message="[&quot;GO DB&quot;]" />
                            <ui:DatabaseConnect DatabaseConnection="[DatabaseConnection1]" DisplayName="Connect" sap:VirtualizedContainerService.HintSize="560,59" sap2010:WorkflowViewState.IdRef="DatabaseConnect_1" ProviderName="System.Data.SqlClient" ConnectionString="[SQLConnectionString]">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:DatabaseConnect>
                            <ui:ExecuteQuery ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="取得對應表" CommandType="Text" DataTable="[PortNameMappingDatatable]" DisplayName="Execute Query" ExistingDbConnection="[DatabaseConnection1]" sap:VirtualizedContainerService.HintSize="560,119" sap2010:WorkflowViewState.IdRef="ExecuteQuery_1" Sql="SELECT * FROM Delivery_Port;">
                              <ui:ExecuteQuery.Parameters>
                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                              </ui:ExecuteQuery.Parameters>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:ExecuteQuery>
                            <ui:DatabaseDisconnect DatabaseConnection="[DatabaseConnection1]" DisplayName="Disconnect" sap:VirtualizedContainerService.HintSize="560,22" sap2010:WorkflowViewState.IdRef="DatabaseDisconnect_1" />
                            <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="get PortNameMappingDatatable list" DataTable="[PortNameMappingDatatable]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="560,720" sap2010:WorkflowViewState.IdRef="ForEachRow_6">
                              <ui:ForEachRow.Body>
                                <ActivityAction x:TypeArguments="sd:DataRow">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CurrentRow" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="526,569" sap2010:WorkflowViewState.IdRef="Sequence_266">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If Condition="[CurrentRow(&quot;Carrier&quot;).ToString.ToUpper.Equals(WorkingCarrierName)]" sap:VirtualizedContainerService.HintSize="484,477" sap2010:WorkflowViewState.IdRef="If_66">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence sap:VirtualizedContainerService.HintSize="242,300" sap2010:WorkflowViewState.IdRef="Sequence_267">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <AddToCollection x:TypeArguments="x:String" Collection="[PortNameMappingDatatablelist]" DisplayName="TWTYN_Add To Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_2" Item="[CurrentRow(&quot;TWTYN&quot;).ToString]" />
                                          <AddToCollection x:TypeArguments="x:String" Collection="[PortNameMappingDatatablelist]" DisplayName="TWTXG_Add To Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_1" Item="[CurrentRow(&quot;TWTXG&quot;).ToString]" />
                                          <AddToCollection x:TypeArguments="x:String" Collection="[PortNameMappingDatatablelist]" DisplayName="TWKHH_Add To Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_3" Item="[CurrentRow(&quot;TWKHH&quot;).ToString]" />
                                          <AddToCollection x:TypeArguments="x:String" Collection="[PortNameMappingDatatablelist]" DisplayName="TWKEL_Add To Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_4" Item="[CurrentRow(&quot;TWKEL&quot;).ToString]" />
                                        </Sequence>
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </ActivityAction>
                              </ui:ForEachRow.Body>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:ForEachRow>
                          </Sequence>
                          <ui:LogMessage DisplayName="&quot;取得港口對應表完成&quot;Log Message" sap:VirtualizedContainerService.HintSize="602,91" sap2010:WorkflowViewState.IdRef="LogMessage_27" Level="Info" Message="[&quot;取得港口對應表完成&quot;]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                          <ui:FilterDataTable sap2010:Annotation.AnnotationText="測試用，應在mapping刪除" DataTable="[WorkingDT]" DisplayName="Filter Data Table" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="602,191" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[WorkingDT]" SelectColumnsMode="Keep">
                            <ui:FilterDataTable.Filters>
                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                                  <ui:FilterOperationArgument.Column>
                                    <InArgument x:TypeArguments="x:String">["CARRIER_BKG_REF"]</InArgument>
                                  </ui:FilterOperationArgument.Column>
                                </ui:FilterOperationArgument>
                              </scg:List>
                            </ui:FilterDataTable.Filters>
                            <ui:FilterDataTable.SelectColumns>
                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                <x:Null />
                              </scg:List>
                            </ui:FilterDataTable.SelectColumns>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:FilterDataTable>
                          <ui:WriteRange AddHeaders="True" DataTable="[WorkingDT]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="602,115" sap2010:WorkflowViewState.IdRef="WriteRange_5" SheetName="[WorkingCarrierName]" StartingCell="A1" WorkbookPath="[RunningTempDTpath]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:WriteRange>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="602,91" sap2010:WorkflowViewState.IdRef="LogMessage_101" Level="Info" Message="[&quot;RunningTempDTpath&quot;+VBCR+RunningTempDTpath]" />
                        </Sequence>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="648,21" sap2010:WorkflowViewState.IdRef="Catch`1_17">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <Assign DisplayName="SytemException is Exception_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_153">
                              <Assign.To>
                                <OutArgument x:TypeArguments="s:Exception">[SystemException]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="s:Exception">[Exception]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1459,91" sap2010:WorkflowViewState.IdRef="LogMessage_92" Level="Info" Message="[&quot;SuccessScreenShotFolder_&quot;+vbCr+SuccessScreenShotFolder]" />
                    <If Condition="[Runtime=1]" DisplayName="資料抓取_If" sap:VirtualizedContainerService.HintSize="1459,4483" sap2010:WorkflowViewState.IdRef="If_5">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="根據每筆WorkDT查找資料(ETA/ETD)&#xA;輸出資料ETA/ETD&#xA;輸出資料Comment&#xA;定義狀態status&#xA;" DataTable="[WorkingDT]" DisplayName="資料抓取_for each CurrentRow" sap:VirtualizedContainerService.HintSize="689,4148" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                          <ui:ForEachRow.Body>
                            <ActivityAction x:TypeArguments="sd:DataRow">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CurrentRow" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Run all_Body" sap:VirtualizedContainerService.HintSize="655,3941" sap2010:WorkflowViewState.IdRef="Sequence_265">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="x:String" Name="bookingNumber" />
                                  <Variable x:TypeArguments="x:String" Name="VarETA" />
                                  <Variable x:TypeArguments="x:String" Name="VarETD" />
                                  <Variable x:TypeArguments="x:String" Name="VarComment" />
                                  <Variable x:TypeArguments="x:String" Name="DelivertPort" />
                                  <Variable x:TypeArguments="x:String" Name="PLACE_OF_DELIVERY" />
                                  <Variable x:TypeArguments="x:String" Name="CARRIER" />
                                  <Variable x:TypeArguments="x:String" Name="PONumber" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Sequence sap2010:Annotation.AnnotationText="資料抓取前Assign：&#xA;CARRIER&#xA;DelivertPort&#xA;PLACE_OF_DELIVERY&#xA;PONumber&#xA;bookingNumber" DisplayName="Assing &amp; log_Sequence" sap:VirtualizedContainerService.HintSize="613,958" sap2010:WorkflowViewState.IdRef="Sequence_256">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="571,51" sap2010:WorkflowViewState.IdRef="CommentOut_66">
                                    <ui:CommentOut.Body>
                                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="305,652" sap2010:WorkflowViewState.IdRef="Sequence_255">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_313">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[CARRIER]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER").ToString]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_314">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[DelivertPort]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("PLACE_OF_DELIVERY").ToString]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_315">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[VarETA]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_316">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[VarETD]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign DisplayName="bookingNumber_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_317">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("CUSTOMER_PO").ToString]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign DisplayName="bookingNumber_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_318">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[bookingNumber]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER_BKG_REF").ToString]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </Sequence>
                                    </ui:CommentOut.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:CommentOut>
                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="571,284" sap2010:WorkflowViewState.IdRef="MultipleAssign_3">
                                    <ui:MultipleAssign.AssignOperations>
                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[CARRIER]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER").ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_13">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[DelivertPort]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("PLACE_OF_DELIVERY").ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[VarETA]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_15">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[VarETD]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_16">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("CUSTOMER_PO").ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_17">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[bookingNumber]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER_BKG_REF").ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_18">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                      </scg:List>
                                    </ui:MultipleAssign.AssignOperations>
                                  </ui:MultipleAssign>
                                  <If Condition="[CARRIER.Equals(&quot;CMDU&quot;)]" sap:VirtualizedContainerService.HintSize="571,218" sap2010:WorkflowViewState.IdRef="If_62">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Assign DisplayName="港口代碼對應真實名稱_Assign(zimu會錯)" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_319">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[PLACE_OF_DELIVERY]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[PortNameMappingDatatable.select("[Carrier]='"+"CHNL"+"'").CopyToDataTable.Rows(0)( DelivertPort).ToString]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Then>
                                    <If.Else>
                                      <Assign DisplayName="港口代碼對應真實名稱_Assign(zimu會錯)" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_320">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[PLACE_OF_DELIVERY]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[PortNameMappingDatatable.select("[Carrier]='"+CARRIER+"'").CopyToDataTable.Rows(0)( DelivertPort).ToString]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Else>
                                  </If>
                                  <ui:LogMessage DisplayName="For each row_資料抓取前_Log Message" sap:VirtualizedContainerService.HintSize="571,91" sap2010:WorkflowViewState.IdRef="LogMessage_113" Level="Info" Message="[&quot;正在查詢單號：&quot;+bookingNumber]" />
                                </Sequence>
                                <TryCatch DisplayName="資料抓取_運行子流程_Try Catch" sap:VirtualizedContainerService.HintSize="613,2486" sap2010:WorkflowViewState.IdRef="TryCatch_27">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <TryCatch.Try>
                                    <Sequence sap2010:Annotation.AnnotationText="資料抓取_Switch&#xA;輸出資料ETA/ETD&#xA;輸出資料Comment&#xA;定義狀態status" DisplayName="SuccessfulStatus_Sequence" sap:VirtualizedContainerService.HintSize="543,2259" sap2010:WorkflowViewState.IdRef="Sequence_261">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Switch x:TypeArguments="x:String" DisplayName="資料抓取Processing_Switch" Expression="[CARRIER]" sap:VirtualizedContainerService.HintSize="501,336" sap2010:WorkflowViewState.IdRef="Switch`1_17">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="CHNL" DisplayName="Invoke CHNL workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_169" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\CHNL.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_delivertPort">[PLACE_OF_DELIVERY]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="EGLV" DisplayName="Invoke EGLV workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_170" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\EGLV.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="bookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="EstimatedArrivalDate">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="EstimatedDepartureDate">[VarETD]</OutArgument>
                                            <InOutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</InOutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_TempFolder">[RunningTempfolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="HDMU" DisplayName="Invoke HDMU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_171" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\HDMU.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                            <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MAEU" DisplayName="Invoke MAEU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_172" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MAEU.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_VarETA">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_VarETD">[VarETD]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_Bookingnumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_Comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="ONEY" DisplayName="Invoke ONEY workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_173" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\ONEY.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_placeOfDelivery">[PLACE_OF_DELIVERY]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SQLconnectstring">[SQLConnectionString]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="WHLC" DisplayName="Invoke WHLC workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_174" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\WHLC.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                            <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MSCU" DisplayName="Invoke MSCU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_175" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MSCU.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                            <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_placeofDelivery">[PLACE_OF_DELIVERY]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="YMLU" DisplayName="Invoke getYMLU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_176" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\getYMLU.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_carrierNumber">[bookingNumber]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_place">[PLACE_OF_DELIVERY]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_ETA">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_ETD">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_COMMENT">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_Tempfolder">[RunningTempfolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MCCQ" DisplayName="Invoke MCCQ workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_177" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MCCQ.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_VarETA">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_VarETD">[VarETD]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_Bookingnumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_Comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:InvokeWorkflowFile>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="CMDU" DisplayName="Invoke CHNL workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_178" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\CHNL.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_delivertPort">[PLACE_OF_DELIVERY]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </Switch>
                                      <If Condition="[CARRIER.Contains(&quot;ZIMU&quot;)]" DisplayName="ZIMU_If" sap:VirtualizedContainerService.HintSize="501,381" sap2010:WorkflowViewState.IdRef="If_63">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence sap:VirtualizedContainerService.HintSize="376,204" sap2010:WorkflowViewState.IdRef="Sequence_257">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke ZIMU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_179" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\ZIMU.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Port">[PLACE_OF_DELIVERY]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_BookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_ETA">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_ETD">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_Commend">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                          </Sequence>
                                        </If.Then>
                                      </If>
                                      <Assign DisplayName="Status_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_321">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("status")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">["Successful"]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Var_ETD/ATD_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_322">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETD/ATD")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">[VarETD]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Var_ETA/ATA_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_323">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETA/ATA")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">[VarETA]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_324">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <If Condition="[VarETD.Length&lt;2 and VarETA.Length&gt;2]" sap:VirtualizedContainerService.HintSize="501,429" sap2010:WorkflowViewState.IdRef="If_64">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence sap:VirtualizedContainerService.HintSize="305,252" sap2010:WorkflowViewState.IdRef="Sequence_258">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_325">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">2</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_326">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </If.Then>
                                      </If>
                                      <If Condition="[VarETD.Length&gt;2 and VarETA.Length&lt;2]" sap:VirtualizedContainerService.HintSize="501,429" sap2010:WorkflowViewState.IdRef="If_65">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence sap:VirtualizedContainerService.HintSize="305,252" sap2010:WorkflowViewState.IdRef="Sequence_259">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_327">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">2</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_328">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="547,21" sap2010:WorkflowViewState.IdRef="Catch`1_28">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                        <Sequence sap2010:Annotation.AnnotationText="資料抓取_Switch&#xA;輸出資料ETA/ETD(N/A)&#xA;輸出資料Comment&#xA;定義狀態status" DisplayName="CrushStatus_Sequence" sap:VirtualizedContainerService.HintSize="418,1673" sap2010:WorkflowViewState.IdRef="Sequence_263">
                                          <Sequence.Variables>
                                            <Variable x:TypeArguments="ui:Image" Name="ScreenShot" />
                                          </Sequence.Variables>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign DisplayName="Status_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_329">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("status")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">["Crush"]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign DisplayName="Var_ETD/ATD_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_330">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETD/ATD")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign DisplayName="Var_ETA/ATA_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_331">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETA/ATA")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_332">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="376,91" sap2010:WorkflowViewState.IdRef="LogMessage_114" Level="Warn" Message="[&quot;子流程出現Crush，需要Retry，目前嘗試次數：&quot;+ Runtime.ToString]" />
                                          <Sequence DisplayName="Take Screen Shot_Sequence" sap:VirtualizedContainerService.HintSize="376,423" sap2010:WorkflowViewState.IdRef="Sequence_262">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:TakeScreenshot DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_11" Screenshot="[ScreenShot]" WaitBefore="1500">
                                              <ui:TakeScreenshot.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="d038ca3f-f3d4-4c31-a3e4-84b88d9ce7a3">
                                                  <ui:Target.TimeoutMS>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:Target.TimeoutMS>
                                                  <ui:Target.WaitForReady>
                                                    <InArgument x:TypeArguments="ui:WaitForReady" />
                                                  </ui:Target.WaitForReady>
                                                </ui:Target>
                                              </ui:TakeScreenshot.Target>
                                            </ui:TakeScreenshot>
                                            <ui:SaveImage DisplayName="Save Image" FileName="[RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" sap:VirtualizedContainerService.HintSize="334,92" sap2010:WorkflowViewState.IdRef="SaveImage_11" Image="[ScreenShot]" />
                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_115" Level="Warn" Message="[&quot;Error Info：Screen SHOT path&quot;+vbCr+&#xA;RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" />
                                          </Sequence>
                                          <ui:TakeScreenshot DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="376,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_12" Screenshot="[ScreenShot]" WaitBefore="1500">
                                            <ui:TakeScreenshot.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="d038ca3f-f3d4-4c31-a3e4-84b88d9ce7a3">
                                                <ui:Target.TimeoutMS>
                                                  <InArgument x:TypeArguments="x:Int32" />
                                                </ui:Target.TimeoutMS>
                                                <ui:Target.WaitForReady>
                                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                                </ui:Target.WaitForReady>
                                              </ui:Target>
                                            </ui:TakeScreenshot.Target>
                                          </ui:TakeScreenshot>
                                          <ui:SaveImage DisplayName="Save Image" FileName="[RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" sap:VirtualizedContainerService.HintSize="376,92" sap2010:WorkflowViewState.IdRef="SaveImage_12" Image="[ScreenShot]" />
                                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="376,91" sap2010:WorkflowViewState.IdRef="LogMessage_116" Level="Warn" Message="[&quot;Error Info：Screen SHOT path&quot;+vbCr+&#xA;RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" />
                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplication workflow" sap:VirtualizedContainerService.HintSize="376,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_180" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                            <ui:InvokeWorkflowFile.Arguments>
                                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                            </ui:InvokeWorkflowFile.Arguments>
                                          </ui:InvokeWorkflowFile>
                                        </Sequence>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                                <Sequence sap2010:Annotation.AnnotationText="Add row counter &#xA;log 抓取結果" DisplayName="Add row counter &amp; log 結果" sap:VirtualizedContainerService.HintSize="613,325" sap2010:WorkflowViewState.IdRef="Sequence_264">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign DisplayName="RowCounter_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_333">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">[RowCounter]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">[RowCounter+1]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:LogMessage DisplayName="Log  抓取結果" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_117" Level="Warn" Message="[&quot;查詢結果：&quot;+&#xA;&quot;Booking Numver：&quot;+ bookingNumber+&quot;__//&quot;+&#xA;&quot;Carrier：&quot;+WorkingCarrierName+&quot;：&quot;+&quot;__//&quot;+&#xA;&quot;Status：&quot;+CurrentRow(&quot;status&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_ETD/ATD：&quot;+CurrentRow(&quot;Var_ETD/ATD&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_ETA/ATA：&quot;+CurrentRow(&quot;Var_ETA/ATA&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_Comment：&quot;+CurrentRow(&quot;Comment&quot;).ToString+&quot;__&quot;]" />
                                </Sequence>
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEachRow.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ForEachRow>
                      </If.Then>
                      <If.Else>
                        <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="根據每筆WorkDT查找資料(ETA/ETD)&#xA;輸出資料ETA/ETD&#xA;輸出資料Comment&#xA;定義狀態status&#xA;" DataTable="[WorkingDT]" DisplayName="資料抓取_for each CurrentRow" sap:VirtualizedContainerService.HintSize="725,4325" sap2010:WorkflowViewState.IdRef="ForEachRow_5">
                          <ui:ForEachRow.Body>
                            <ActivityAction x:TypeArguments="sd:DataRow">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CurrentRow" />
                              </ActivityAction.Argument>
                              <If Condition="[CurrentRow(&quot;status&quot;).ToString.Contains(&quot;Crush&quot;)]" DisplayName="Run Crush_Body_If" sap:VirtualizedContainerService.HintSize="691,4118" sap2010:WorkflowViewState.IdRef="If_20">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Run all_Body" sap:VirtualizedContainerService.HintSize="655,3941" sap2010:WorkflowViewState.IdRef="Sequence_278">
                                    <Sequence.Variables>
                                      <Variable x:TypeArguments="x:String" Name="bookingNumber" />
                                      <Variable x:TypeArguments="x:String" Name="VarETA" />
                                      <Variable x:TypeArguments="x:String" Name="VarETD" />
                                      <Variable x:TypeArguments="x:String" Name="VarComment" />
                                      <Variable x:TypeArguments="x:String" Name="DelivertPort" />
                                      <Variable x:TypeArguments="x:String" Name="PLACE_OF_DELIVERY" />
                                      <Variable x:TypeArguments="x:String" Name="CARRIER" />
                                      <Variable x:TypeArguments="x:String" Name="PONumber" />
                                    </Sequence.Variables>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence sap2010:Annotation.AnnotationText="資料抓取前Assign：&#xA;CARRIER&#xA;DelivertPort&#xA;PLACE_OF_DELIVERY&#xA;PONumber&#xA;bookingNumber" DisplayName="Assing &amp; log_Sequence" sap:VirtualizedContainerService.HintSize="613,958" sap2010:WorkflowViewState.IdRef="Sequence_269">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="571,51" sap2010:WorkflowViewState.IdRef="CommentOut_68">
                                        <ui:CommentOut.Body>
                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="305,652" sap2010:WorkflowViewState.IdRef="Sequence_268">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_334">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[CARRIER]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER").ToString]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_335">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[DelivertPort]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("PLACE_OF_DELIVERY").ToString]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_336">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[VarETA]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_337">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[VarETD]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign DisplayName="bookingNumber_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_338">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("CUSTOMER_PO").ToString]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign DisplayName="bookingNumber_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_339">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[bookingNumber]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER_BKG_REF").ToString]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </ui:CommentOut.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:CommentOut>
                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="571,284" sap2010:WorkflowViewState.IdRef="MultipleAssign_4">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_20">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[CARRIER]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_21">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[DelivertPort]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("PLACE_OF_DELIVERY").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_22">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[VarETA]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_23">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[VarETD]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_24">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("CUSTOMER_PO").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_25">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[bookingNumber]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER_BKG_REF").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_26">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                      <If Condition="[CARRIER.Equals(&quot;CMDU&quot;)]" sap:VirtualizedContainerService.HintSize="571,218" sap2010:WorkflowViewState.IdRef="If_67">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Assign DisplayName="港口代碼對應真實名稱_Assign(zimu會錯)" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_340">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[PLACE_OF_DELIVERY]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[PortNameMappingDatatable.select("[Carrier]='"+"CHNL"+"'").CopyToDataTable.Rows(0)( DelivertPort).ToString]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Then>
                                        <If.Else>
                                          <Assign DisplayName="港口代碼對應真實名稱_Assign(zimu會錯)" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_341">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[PLACE_OF_DELIVERY]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[PortNameMappingDatatable.select("[Carrier]='"+CARRIER+"'").CopyToDataTable.Rows(0)( DelivertPort).ToString]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Else>
                                      </If>
                                      <ui:LogMessage DisplayName="For each row_資料抓取前_Log Message" sap:VirtualizedContainerService.HintSize="571,91" sap2010:WorkflowViewState.IdRef="LogMessage_118" Level="Info" Message="[&quot;正在查詢單號：&quot;+bookingNumber]" />
                                    </Sequence>
                                    <TryCatch DisplayName="資料抓取_運行子流程_Try Catch" sap:VirtualizedContainerService.HintSize="613,2486" sap2010:WorkflowViewState.IdRef="TryCatch_28">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <Sequence sap2010:Annotation.AnnotationText="資料抓取_Switch&#xA;輸出資料ETA/ETD&#xA;輸出資料Comment&#xA;定義狀態status" DisplayName="SuccessfulStatus_Sequence" sap:VirtualizedContainerService.HintSize="543,2259" sap2010:WorkflowViewState.IdRef="Sequence_274">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Switch x:TypeArguments="x:String" DisplayName="資料抓取Processing_Switch" Expression="[CARRIER]" sap:VirtualizedContainerService.HintSize="501,336" sap2010:WorkflowViewState.IdRef="Switch`1_18">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="CHNL" DisplayName="Invoke CHNL workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_181" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\CHNL.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_delivertPort">[PLACE_OF_DELIVERY]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="EGLV" DisplayName="Invoke EGLV workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_182" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\EGLV.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="bookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="EstimatedArrivalDate">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="EstimatedDepartureDate">[VarETD]</OutArgument>
                                                <InOutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</InOutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_TempFolder">[RunningTempfolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="HDMU" DisplayName="Invoke HDMU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_183" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\HDMU.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                                <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MAEU" DisplayName="Invoke MAEU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_184" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MAEU.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_VarETA">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_VarETD">[VarETD]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Bookingnumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_Comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="ONEY" DisplayName="Invoke ONEY workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_185" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\ONEY.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_placeOfDelivery">[PLACE_OF_DELIVERY]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SQLconnectstring">[SQLConnectionString]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="WHLC" DisplayName="Invoke WHLC workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_186" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\WHLC.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                                <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MSCU" DisplayName="Invoke MSCU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_187" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MSCU.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                                <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_placeofDelivery">[PLACE_OF_DELIVERY]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="YMLU" DisplayName="Invoke getYMLU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_188" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\getYMLU.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_carrierNumber">[bookingNumber]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_place">[PLACE_OF_DELIVERY]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_ETA">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_ETD">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_COMMENT">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Tempfolder">[RunningTempfolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MCCQ" DisplayName="Invoke MCCQ workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_189" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MCCQ.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_VarETA">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_VarETD">[VarETD]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_Bookingnumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_Comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:InvokeWorkflowFile>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="CMDU" DisplayName="Invoke CHNL workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_190" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\CHNL.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                                <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_delivertPort">[PLACE_OF_DELIVERY]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                          </Switch>
                                          <If Condition="[CARRIER.Contains(&quot;ZIMU&quot;)]" DisplayName="ZIMU_If" sap:VirtualizedContainerService.HintSize="501,381" sap2010:WorkflowViewState.IdRef="If_68">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence sap:VirtualizedContainerService.HintSize="376,204" sap2010:WorkflowViewState.IdRef="Sequence_270">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke ZIMU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_191" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\ZIMU.xaml">
                                                  <ui:InvokeWorkflowFile.Arguments>
                                                    <InArgument x:TypeArguments="x:String" x:Key="in_Port">[PLACE_OF_DELIVERY]</InArgument>
                                                    <InArgument x:TypeArguments="x:String" x:Key="in_BookingNumber">[bookingNumber]</InArgument>
                                                    <OutArgument x:TypeArguments="x:String" x:Key="out_ETA">[VarETA]</OutArgument>
                                                    <OutArgument x:TypeArguments="x:String" x:Key="out_ETD">[VarETD]</OutArgument>
                                                    <OutArgument x:TypeArguments="x:String" x:Key="out_Commend">[VarComment]</OutArgument>
                                                    <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                                    <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                                  </ui:InvokeWorkflowFile.Arguments>
                                                </ui:InvokeWorkflowFile>
                                              </Sequence>
                                            </If.Then>
                                          </If>
                                          <Assign DisplayName="Status_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_342">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("status")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">["Successful"]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign DisplayName="Var_ETD/ATD_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_343">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETD/ATD")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">[VarETD]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign DisplayName="Var_ETA/ATA_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_344">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETA/ATA")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">[VarETA]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_345">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <If Condition="[VarETD.Length&lt;2 and VarETA.Length&gt;2]" sap:VirtualizedContainerService.HintSize="501,429" sap2010:WorkflowViewState.IdRef="If_69">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence sap:VirtualizedContainerService.HintSize="305,252" sap2010:WorkflowViewState.IdRef="Sequence_271">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_346">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">2</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_347">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                            </If.Then>
                                          </If>
                                          <If Condition="[VarETD.Length&gt;2 and VarETA.Length&lt;2]" sap:VirtualizedContainerService.HintSize="501,429" sap2010:WorkflowViewState.IdRef="If_70">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence sap:VirtualizedContainerService.HintSize="305,252" sap2010:WorkflowViewState.IdRef="Sequence_272">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_348">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">2</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_349">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                            </If.Then>
                                          </If>
                                        </Sequence>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="547,21" sap2010:WorkflowViewState.IdRef="Catch`1_29">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <Sequence sap2010:Annotation.AnnotationText="資料抓取_Switch&#xA;輸出資料ETA/ETD(N/A)&#xA;輸出資料Comment&#xA;定義狀態status" DisplayName="CrushStatus_Sequence" sap:VirtualizedContainerService.HintSize="418,1673" sap2010:WorkflowViewState.IdRef="Sequence_276">
                                              <Sequence.Variables>
                                                <Variable x:TypeArguments="ui:Image" Name="ScreenShot" />
                                              </Sequence.Variables>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign DisplayName="Status_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_350">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Object">[CurrentRow("status")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Object">["Crush"]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <Assign DisplayName="Var_ETD/ATD_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_351">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETD/ATD")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <Assign DisplayName="Var_ETA/ATA_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_352">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETA/ATA")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_353">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="376,91" sap2010:WorkflowViewState.IdRef="LogMessage_119" Level="Warn" Message="[&quot;子流程出現Crush，需要Retry，目前嘗試次數：&quot;+ Runtime.ToString]" />
                                              <Sequence DisplayName="Take Screen Shot_Sequence" sap:VirtualizedContainerService.HintSize="376,423" sap2010:WorkflowViewState.IdRef="Sequence_275">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:TakeScreenshot DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_13" Screenshot="[ScreenShot]" WaitBefore="1500">
                                                  <ui:TakeScreenshot.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="d038ca3f-f3d4-4c31-a3e4-84b88d9ce7a3">
                                                      <ui:Target.TimeoutMS>
                                                        <InArgument x:TypeArguments="x:Int32" />
                                                      </ui:Target.TimeoutMS>
                                                      <ui:Target.WaitForReady>
                                                        <InArgument x:TypeArguments="ui:WaitForReady" />
                                                      </ui:Target.WaitForReady>
                                                    </ui:Target>
                                                  </ui:TakeScreenshot.Target>
                                                </ui:TakeScreenshot>
                                                <ui:SaveImage DisplayName="Save Image" FileName="[RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" sap:VirtualizedContainerService.HintSize="334,92" sap2010:WorkflowViewState.IdRef="SaveImage_13" Image="[ScreenShot]" />
                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_120" Level="Warn" Message="[&quot;Error Info：Screen SHOT path&quot;+vbCr+&#xA;RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" />
                                              </Sequence>
                                              <ui:TakeScreenshot DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="376,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_14" Screenshot="[ScreenShot]" WaitBefore="1500">
                                                <ui:TakeScreenshot.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="d038ca3f-f3d4-4c31-a3e4-84b88d9ce7a3">
                                                    <ui:Target.TimeoutMS>
                                                      <InArgument x:TypeArguments="x:Int32" />
                                                    </ui:Target.TimeoutMS>
                                                    <ui:Target.WaitForReady>
                                                      <InArgument x:TypeArguments="ui:WaitForReady" />
                                                    </ui:Target.WaitForReady>
                                                  </ui:Target>
                                                </ui:TakeScreenshot.Target>
                                              </ui:TakeScreenshot>
                                              <ui:SaveImage DisplayName="Save Image" FileName="[RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" sap:VirtualizedContainerService.HintSize="376,92" sap2010:WorkflowViewState.IdRef="SaveImage_14" Image="[ScreenShot]" />
                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="376,91" sap2010:WorkflowViewState.IdRef="LogMessage_121" Level="Warn" Message="[&quot;Error Info：Screen SHOT path&quot;+vbCr+&#xA;RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" />
                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplication workflow" sap:VirtualizedContainerService.HintSize="376,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_192" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                                <ui:InvokeWorkflowFile.Arguments>
                                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                </ui:InvokeWorkflowFile.Arguments>
                                              </ui:InvokeWorkflowFile>
                                            </Sequence>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <Sequence sap2010:Annotation.AnnotationText="Add row counter &#xA;log 抓取結果" DisplayName="Add row counter &amp; log 結果" sap:VirtualizedContainerService.HintSize="613,325" sap2010:WorkflowViewState.IdRef="Sequence_277">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="RowCounter_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_354">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[RowCounter]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">[RowCounter+1]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:LogMessage DisplayName="Log  抓取結果" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_122" Level="Warn" Message="[&quot;查詢結果：&quot;+&#xA;&quot;Booking Numver：&quot;+ bookingNumber+&quot;__//&quot;+&#xA;&quot;Carrier：&quot;+WorkingCarrierName+&quot;：&quot;+&quot;__//&quot;+&#xA;&quot;Status：&quot;+CurrentRow(&quot;status&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_ETD/ATD：&quot;+CurrentRow(&quot;Var_ETD/ATD&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_ETA/ATA：&quot;+CurrentRow(&quot;Var_ETA/ATA&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_Comment：&quot;+CurrentRow(&quot;Comment&quot;).ToString+&quot;__&quot;]" />
                                    </Sequence>
                                  </Sequence>
                                </If.Then>
                              </If>
                            </ActivityAction>
                          </ui:ForEachRow.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ForEachRow>
                      </If.Else>
                    </If>
                    <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1459,51" sap2010:WorkflowViewState.IdRef="CommentOut_63">
                      <ui:CommentOut.Body>
                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="697,158" sap2010:WorkflowViewState.IdRef="Sequence_251">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence DisplayName="Run all_Body" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_250">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="x:String" Name="bookingNumber" />
                              <Variable x:TypeArguments="x:String" Name="VarETA" />
                              <Variable x:TypeArguments="x:String" Name="VarETD" />
                              <Variable x:TypeArguments="x:String" Name="VarComment" />
                              <Variable x:TypeArguments="x:String" Name="DelivertPort" />
                              <Variable x:TypeArguments="x:String" Name="PLACE_OF_DELIVERY" />
                              <Variable x:TypeArguments="x:String" Name="CARRIER" />
                              <Variable x:TypeArguments="x:String" Name="PONumber" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Sequence sap2010:Annotation.AnnotationText="資料抓取前Assign：&#xA;CARRIER&#xA;DelivertPort&#xA;PLACE_OF_DELIVERY&#xA;PONumber&#xA;bookingNumber" DisplayName="Assing &amp; log_Sequence" sap:VirtualizedContainerService.HintSize="613,943" sap2010:WorkflowViewState.IdRef="Sequence_242">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="571,60" sap2010:WorkflowViewState.IdRef="Assign_290">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[CARRIER]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER").ToString]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign sap:VirtualizedContainerService.HintSize="571,60" sap2010:WorkflowViewState.IdRef="Assign_291">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[DelivertPort]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[CurrentRow("PLACE_OF_DELIVERY").ToString]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <If Condition="[CARRIER.Equals(&quot;CMDU&quot;)]" sap:VirtualizedContainerService.HintSize="571,218" sap2010:WorkflowViewState.IdRef="If_56">
                                <If.Then>
                                  <Assign DisplayName="港口代碼對應真實名稱_Assign(zimu會錯)" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_292">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[PLACE_OF_DELIVERY]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[PortNameMappingDatatable.select("[Carrier]='"+"CHNL"+"'").CopyToDataTable.Rows(0)( DelivertPort).ToString]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Then>
                                <If.Else>
                                  <Assign DisplayName="港口代碼對應真實名稱_Assign(zimu會錯)" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_293">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[PLACE_OF_DELIVERY]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[PortNameMappingDatatable.select("[Carrier]='"+CARRIER+"'").CopyToDataTable.Rows(0)( DelivertPort).ToString]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Else>
                              </If>
                              <Assign DisplayName="bookingNumber_Assign" sap:VirtualizedContainerService.HintSize="571,60" sap2010:WorkflowViewState.IdRef="Assign_294">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[PONumber]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[CurrentRow("CUSTOMER_PO").ToString]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign DisplayName="bookingNumber_Assign" sap:VirtualizedContainerService.HintSize="571,60" sap2010:WorkflowViewState.IdRef="Assign_295">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[bookingNumber]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[CurrentRow("CARRIER_BKG_REF").ToString]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="For each row_資料抓取前_Log Message" sap:VirtualizedContainerService.HintSize="571,91" sap2010:WorkflowViewState.IdRef="LogMessage_108" Level="Info" Message="[&quot;正在查詢單號：&quot;+bookingNumber]" />
                            </Sequence>
                            <TryCatch DisplayName="資料抓取_運行子流程_Try Catch" sap:VirtualizedContainerService.HintSize="613,3198" sap2010:WorkflowViewState.IdRef="TryCatch_26">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <TryCatch.Try>
                                <Sequence sap2010:Annotation.AnnotationText="資料抓取_Switch&#xA;輸出資料ETA/ETD&#xA;輸出資料Comment&#xA;定義狀態status" DisplayName="SuccessfulStatus_Sequence" sap:VirtualizedContainerService.HintSize="543,2971" sap2010:WorkflowViewState.IdRef="Sequence_246">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Switch x:TypeArguments="x:String" DisplayName="資料抓取Processing_Switch" Expression="[CARRIER]" sap:VirtualizedContainerService.HintSize="501,494" sap2010:WorkflowViewState.IdRef="Switch`1_16">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="CHNL" DisplayName="Invoke CHNL workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_157" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\CHNL.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_delivertPort">[PLACE_OF_DELIVERY]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="EGLV" DisplayName="Invoke EGLV workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_158" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\EGLV.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="bookingNumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="EstimatedArrivalDate">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="EstimatedDepartureDate">[VarETD]</OutArgument>
                                        <InOutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</InOutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_TempFolder">[RunningTempfolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="HDMU" DisplayName="Invoke HDMU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_159" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\HDMU.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MAEU" DisplayName="Invoke MAEU workflow" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_160" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MAEU.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_VarETA">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_VarETD">[VarETD]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Bookingnumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_Comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="ONEY" DisplayName="Invoke ONEY workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_161" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\ONEY.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_placeOfDelivery">[PLACE_OF_DELIVERY]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SQLconnectstring">[SQLConnectionString]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="WHLC" DisplayName="Invoke WHLC workflow" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_162" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\WHLC.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MSCU" DisplayName="Invoke MSCU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_163" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MSCU.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                        <InArgument x:TypeArguments="x:Int32" x:Key="in_counter">[RowCounter]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_placeofDelivery">[PLACE_OF_DELIVERY]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="YMLU" DisplayName="Invoke getYMLU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_164" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\getYMLU.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_carrierNumber">[bookingNumber]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_place">[PLACE_OF_DELIVERY]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_ETA">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_ETD">[VarETD]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_COMMENT">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Tempfolder">[RunningTempfolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="MCCQ" DisplayName="Invoke MCCQ workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_165" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MCCQ.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_VarETA">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_VarETD">[VarETD]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_Bookingnumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_Comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" x:Key="CMDU" DisplayName="Invoke CHNL workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_166" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\CHNL.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="TempFolder">[RunningTempfolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_bookingNumber">[bookingNumber]</InArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedArrivalDate">[VarETA]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_estimatedDepartureDate">[VarETD]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="out_comment">[VarComment]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_delivertPort">[PLACE_OF_DELIVERY]</InArgument>
                                        <InOutArgument x:TypeArguments="sd:DataTable" x:Key="io_portNameMappingDatatable">[PortNameMappingDatatable]</InOutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                  </Switch>
                                  <If Condition="[CARRIER.Contains(&quot;ZIMU&quot;)]" DisplayName="ZIMU_If" sap:VirtualizedContainerService.HintSize="501,381" sap2010:WorkflowViewState.IdRef="If_57">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="376,204" sap2010:WorkflowViewState.IdRef="Sequence_243">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke ZIMU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_167" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\ZIMU.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_Port">[PLACE_OF_DELIVERY]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_BookingNumber">[bookingNumber]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_ETA">[VarETA]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_ETD">[VarETD]</OutArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="out_Commend">[VarComment]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_SuccessScreenShotFolder">[SuccessScreenShotFolder]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_PoNumber">[PONumber]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                  <Assign DisplayName="Status_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_296">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Object">[CurrentRow("status")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Object">["Successful"]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign DisplayName="Var_ETD/ATD_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_297">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETD/ATD")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Object">[VarETD]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign DisplayName="Var_ETA/ATA_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_298">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETA/ATA")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Object">[VarETA]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="501,60" sap2010:WorkflowViewState.IdRef="Assign_299">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <If Condition="[VarETD is Nothing]" sap:VirtualizedContainerService.HintSize="501,237" sap2010:WorkflowViewState.IdRef="If_58">
                                    <If.Then>
                                      <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_300">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[VarETD]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <Literal x:TypeArguments="x:String" Value="" />
                                          </InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Then>
                                  </If>
                                  <If Condition="[VarETA is Nothing]" sap:VirtualizedContainerService.HintSize="501,237" sap2010:WorkflowViewState.IdRef="If_59">
                                    <If.Then>
                                      <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_301">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[VarETA]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <Literal x:TypeArguments="x:String" Value="" />
                                          </InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Then>
                                  </If>
                                  <If Condition="[VarETD.Length&lt;2 and VarETA.Length&gt;2]" sap:VirtualizedContainerService.HintSize="501,429" sap2010:WorkflowViewState.IdRef="If_60">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="305,252" sap2010:WorkflowViewState.IdRef="Sequence_244">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_302">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">2</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_303">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                  <If Condition="[VarETD.Length&gt;2 and VarETA.Length&lt;2]" sap:VirtualizedContainerService.HintSize="501,429" sap2010:WorkflowViewState.IdRef="If_61">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="305,252" sap2010:WorkflowViewState.IdRef="Sequence_245">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Assign sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_304">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[VarComment]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">2</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_305">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:Object">[VarComment]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                </Sequence>
                              </TryCatch.Try>
                              <TryCatch.Catches>
                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="547,21" sap2010:WorkflowViewState.IdRef="Catch`1_27">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ActivityAction x:TypeArguments="s:Exception">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                    </ActivityAction.Argument>
                                    <Sequence sap2010:Annotation.AnnotationText="資料抓取_Switch&#xA;輸出資料ETA/ETD(N/A)&#xA;輸出資料Comment&#xA;定義狀態status" DisplayName="CrushStatus_Sequence" sap:VirtualizedContainerService.HintSize="418,1641" sap2010:WorkflowViewState.IdRef="Sequence_248">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="ui:Image" Name="ScreenShot" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="Status_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_306">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("status")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">["Crush"]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Var_ETD/ATD_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_307">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETD/ATD")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Var_ETA/ATA_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_308">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("Var_ETA/ATA")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Var_Comment_Assign" sap:VirtualizedContainerService.HintSize="376,60" sap2010:WorkflowViewState.IdRef="Assign_309">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[CurrentRow("Comment")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">[""]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="376,91" sap2010:WorkflowViewState.IdRef="LogMessage_109" Level="Warn" Message="[&quot;子流程出現Crush，需要Retry，目前嘗試次數：&quot;+ Runtime.ToString]" />
                                      <Sequence DisplayName="Take Screen Shot_Sequence" sap:VirtualizedContainerService.HintSize="376,423" sap2010:WorkflowViewState.IdRef="Sequence_247">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:TakeScreenshot DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_9" Screenshot="[ScreenShot]" WaitBefore="1500">
                                          <ui:TakeScreenshot.Target>
                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="d038ca3f-f3d4-4c31-a3e4-84b88d9ce7a3">
                                              <ui:Target.TimeoutMS>
                                                <InArgument x:TypeArguments="x:Int32" />
                                              </ui:Target.TimeoutMS>
                                              <ui:Target.WaitForReady>
                                                <InArgument x:TypeArguments="ui:WaitForReady" />
                                              </ui:Target.WaitForReady>
                                            </ui:Target>
                                          </ui:TakeScreenshot.Target>
                                        </ui:TakeScreenshot>
                                        <ui:SaveImage DisplayName="Save Image" FileName="[RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" sap:VirtualizedContainerService.HintSize="334,92" sap2010:WorkflowViewState.IdRef="SaveImage_9" Image="[ScreenShot]" />
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_110" Level="Warn" Message="[&quot;Error Info：Screen SHOT path&quot;+vbCr+&#xA;RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" />
                                      </Sequence>
                                      <ui:TakeScreenshot DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="376,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_10" Screenshot="[ScreenShot]" WaitBefore="1500">
                                        <ui:TakeScreenshot.Target>
                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="d038ca3f-f3d4-4c31-a3e4-84b88d9ce7a3">
                                            <ui:Target.TimeoutMS>
                                              <InArgument x:TypeArguments="x:Int32" />
                                            </ui:Target.TimeoutMS>
                                            <ui:Target.WaitForReady>
                                              <InArgument x:TypeArguments="ui:WaitForReady" />
                                            </ui:Target.WaitForReady>
                                          </ui:Target>
                                        </ui:TakeScreenshot.Target>
                                      </ui:TakeScreenshot>
                                      <ui:SaveImage DisplayName="Save Image" FileName="[RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" sap:VirtualizedContainerService.HintSize="376,92" sap2010:WorkflowViewState.IdRef="SaveImage_10" Image="[ScreenShot]" />
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="376,91" sap2010:WorkflowViewState.IdRef="LogMessage_111" Level="Warn" Message="[&quot;Error Info：Screen SHOT path&quot;+vbCr+&#xA;RunningTempfolder+&quot;\&quot;+Now.ToString(&quot;yyyy.MM.dd.HH.mm&quot;)+&quot;.jpg&quot;]" />
                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplication workflow" sap:VirtualizedContainerService.HintSize="376,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_168" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                    </Sequence>
                                  </ActivityAction>
                                </Catch>
                              </TryCatch.Catches>
                            </TryCatch>
                            <Sequence sap2010:Annotation.AnnotationText="Add row counter &#xA;log 抓取結果" DisplayName="Add row counter &amp; log 結果" sap:VirtualizedContainerService.HintSize="613,325" sap2010:WorkflowViewState.IdRef="Sequence_249">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="RowCounter_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_310">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[RowCounter]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[RowCounter+1]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="Log  抓取結果" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_112" Level="Warn" Message="[&quot;查詢結果：&quot;+&#xA;&quot;Booking Numver：&quot;+ bookingNumber+&quot;__//&quot;+&#xA;&quot;Carrier：&quot;+WorkingCarrierName+&quot;：&quot;+&quot;__//&quot;+&#xA;&quot;Status：&quot;+CurrentRow(&quot;status&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_ETD/ATD：&quot;+CurrentRow(&quot;Var_ETD/ATD&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_ETA/ATA：&quot;+CurrentRow(&quot;Var_ETA/ATA&quot;).ToString+&quot;__//&quot;+&#xA;&quot;Var_Comment：&quot;+CurrentRow(&quot;Comment&quot;).ToString+&quot;__&quot;]" />
                            </Sequence>
                          </Sequence>
                        </Sequence>
                      </ui:CommentOut.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:CommentOut>
                    <ui:WriteRange AddHeaders="True" DataTable="[WorkingDT]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="1459,115" sap2010:WorkflowViewState.IdRef="WriteRange_6" SheetName="[WorkingCarrierName]" StartingCell="A1" WorkbookPath="[RunningTempDTpath]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:WriteRange>
                    <Assign DisplayName="ErroeRowCounter_Assign" sap:VirtualizedContainerService.HintSize="1459,60" sap2010:WorkflowViewState.IdRef="Assign_155">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[ErrorRowCounter]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">[WorkingDT.AsEnumerable().Where(Function(row) row(“status”).ToString.Contains("Crush”)).ToArray().Count]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <If Condition="[ErrorRowCounter&gt;0]" sap:VirtualizedContainerService.HintSize="1459,822" sap2010:WorkflowViewState.IdRef="If_21">
                      <If.Then>
                        <Sequence DisplayName="ErroeRowCounter&gt;0" sap:VirtualizedContainerService.HintSize="839,664" sap2010:WorkflowViewState.IdRef="Sequence_86">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="ErroeRowCounter&gt;0_Log Message" sap:VirtualizedContainerService.HintSize="797,91" sap2010:WorkflowViewState.IdRef="LogMessage_45" Level="Trace" Message="[&quot;Process Status setting , runtime = &quot;+Runtime.ToString+vbCr+&#xA;&quot;ErroeRowCounter = &quot;+ErrorRowCounter.ToString]" />
                          <If Condition="[Runtime&lt;3]" sap:VirtualizedContainerService.HintSize="797,441" sap2010:WorkflowViewState.IdRef="If_22">
                            <If.Then>
                              <Sequence DisplayName="Runtime&lt;3,ErrorRow&gt;0" sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_87">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign DisplayName="BusinessException_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_156">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">["Process runtime ："+ Runtime.ToString+"  Need Retry"]</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_47" Level="Warn" Message="[&quot;確認是否需要Retry:&quot;+(Runtime&lt;3).ToString+vbCr+BusinessException]" />
                              </Sequence>
                            </If.Then>
                            <If.Else>
                              <Sequence DisplayName="Go End process_Sequence" sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_88">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_48" Level="Warn" Message="[&quot;確認是否需要Retry:&quot;+(Runtime&lt;3).ToString+vbCr+&#xA;&quot;Process runtime ：&quot;+ Runtime.ToString+&quot; Retry time is out of limit, Go End Process&quot;]" />
                                <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_177">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </Sequence>
                            </If.Else>
                          </If>
                        </Sequence>
                      </If.Then>
                      <If.Else>
                        <Sequence sap:VirtualizedContainerService.HintSize="376,283" sap2010:WorkflowViewState.IdRef="Sequence_101">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="ErroeRowCounter&lt;=0_Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_46" Level="Warn" Message="[&quot;Process Satus Setting , Runtime = &quot;+ Runtime.ToString+&quot;，確認是否需要Retry:&quot;+(ErrorRowCounter&gt;0).ToString+&quot;Go End Process&quot;]" />
                          <Assign DisplayName="BusinessException is nothing_Assign" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_157">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[BusinessException]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[Nothing]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </Sequence>
                      </If.Else>
                    </If>
                    <Assign sap:VirtualizedContainerService.HintSize="1459,60" sap2010:WorkflowViewState.IdRef="Assign_176">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[Runtime]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">[Runtime+1]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1459,51" sap2010:WorkflowViewState.IdRef="CommentOut_3">
                      <ui:CommentOut.Body>
                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="480,143" sap2010:WorkflowViewState.IdRef="Sequence_26">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_5">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <TryCatch.Try>
                              <Sequence sap:VirtualizedContainerService.HintSize="376,204" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke MAEU workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_7" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Data Extraction Process\MAEU.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="sd:DataTable" x:Key="in_WorkingDT">[WorkingDT]</InArgument>
                                    <InArgument x:TypeArguments="x:Int32" x:Key="in_runtime">[Runtime]</InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                              </Sequence>
                            </TryCatch.Try>
                            <TryCatch.Catches>
                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_6">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ActivityAction x:TypeArguments="s:Exception">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                  </ActivityAction.Argument>
                                  <Sequence sap:VirtualizedContainerService.HintSize="376,468" sap2010:WorkflowViewState.IdRef="Sequence_14">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_13">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Int32">[ErrorRowCounter]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Int32">[WorkingDT.AsEnumerable().Where(Function(row) row(“status”).ToString.Contains("successful”)).ToArray().Count]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_8" Level="Warn" Message="[&quot;發生錯誤筆數：&quot;+ErrorRowCounter.ToString]" />
                                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_14">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Object">[WorkingDT.Rows(ErrorRowCounter).Item("status")]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Object">["Crush"]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:WriteRange AddHeaders="True" DataTable="[WorkingDT]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="WriteRange_1" SheetName="RunningStatus" StartingCell="A1" WorkbookPath="[Config(&quot;試算用報表_Temp&quot;).ToString]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:WriteRange>
                                  </Sequence>
                                </ActivityAction>
                              </Catch>
                            </TryCatch.Catches>
                            <TryCatch.Finally>
                              <ui:CommentOut sap2010:Annotation.AnnotationText="待定_變更變更Carrier Queue內Transaction狀態" DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="436,294" sap2010:WorkflowViewState.IdRef="CommentOut_2">
                                <ui:CommentOut.Body>
                                  <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="242,185" sap2010:WorkflowViewState.IdRef="Sequence_20">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="處理Working Queue item狀態" DataTable="[WorkingDT]" DisplayName="變更Carrier Queue內Transaction狀態_For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                                      <ui:ForEachRow.Body>
                                        <ActivityAction x:TypeArguments="sd:DataRow">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CurrentRow" />
                                          </ActivityAction.Argument>
                                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="526,505" sap2010:WorkflowViewState.IdRef="Sequence_18">
                                            <Sequence.Variables>
                                              <Variable x:TypeArguments="ui:QueueItem" Name="ChangingStatusTransac" />
                                            </Sequence.Variables>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If Condition="[CurrentRow(&quot;status&quot;).ToString.Contains(&quot;successful&quot;)]" sap:VirtualizedContainerService.HintSize="484,413" sap2010:WorkflowViewState.IdRef="If_3">
                                              <If.Then>
                                                <Sequence sap:VirtualizedContainerService.HintSize="242,236" sap2010:WorkflowViewState.IdRef="Sequence_19">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:GetQueueItem ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Get Transaction Item" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="GetQueueItem_1" QueueType="[WorkingCarrierName]" TransactionItem="[ChangingStatusTransac]" />
                                                  <ui:SetTransactionStatus ContinueOnError="{x:Null}" Reason="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="新增成功狀態" DisplayName="Set Transaction Status" ErrorType="Business" sap:VirtualizedContainerService.HintSize="200,82" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_3" Status="Successful" TransactionItem="[ChangingStatusTransac]">
                                                    <ui:SetTransactionStatus.Analytics>
                                                      <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                    </ui:SetTransactionStatus.Analytics>
                                                    <ui:SetTransactionStatus.Output>
                                                      <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                    </ui:SetTransactionStatus.Output>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:SetTransactionStatus>
                                                </Sequence>
                                              </If.Then>
                                            </If>
                                          </Sequence>
                                        </ActivityAction>
                                      </ui:ForEachRow.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ForEachRow>
                                  </Sequence>
                                </ui:CommentOut.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:CommentOut>
                            </TryCatch.Finally>
                          </TryCatch>
                        </Sequence>
                      </ui:CommentOut.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:CommentOut>
                  </Sequence>
                </State.Entry>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">303.5,427.5</av:Point>
                    <av:Size x:Key="ShapeSize">253,125</av:Size>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Double x:Key="StateContainerWidth">219</x:Double>
                    <x:Double x:Key="StateContainerHeight">88.519999999999982</x:Double>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <State.Transitions>
                  <Transition DisplayName="Retry" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_7">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:PointCollection x:Key="ConnectorLocation">556.5,440 598.5,440 598.5,341.25 556.5,341.25</av:PointCollection>
                        <x:Int32 x:Key="SrcConnectionPointIndex">4</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">56</x:Int32>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <x:Reference>__ReferenceID14</x:Reference>
                    </Transition.To>
                    <Transition.Action>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_44" Level="Warn" Message="[&quot;Go back to Transactoin and Retry&quot;]" />
                    </Transition.Action>
                    <Transition.Condition>
                      <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="BusinessException isnot Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
                    </Transition.Condition>
                  </Transition>
                  <Transition DisplayName="SystemException occured" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_8">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:PointCollection x:Key="ConnectorLocation">556.5,490 658.5,490 658.5,123.75 556.5,123.75</av:PointCollection>
                        <x:Int32 x:Key="SrcConnectionPointIndex">36</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">32</x:Int32>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <State x:Name="__ReferenceID25" DisplayName="Config" sap:VirtualizedContainerService.HintSize="253,125" sap2010:WorkflowViewState.IdRef="State_7">
                        <State.Entry>
                          <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="564,1183" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                            <TryCatch.Try>
                              <Sequence DisplayName="Main_Config_Sequence" sap:VirtualizedContainerService.HintSize="526,956" sap2010:WorkflowViewState.IdRef="Sequence_3">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[Runtime=0]" sap:VirtualizedContainerService.HintSize="484,329" sap2010:WorkflowViewState.IdRef="If_2">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence sap:VirtualizedContainerService.HintSize="305,152" sap2010:WorkflowViewState.IdRef="Sequence_49">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="Runtime_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_3">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[Runtime]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">1</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </If.Then>
                                </If>
                                <Assign sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_6">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="sd:DataTable">[WorkingDT]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="sd:DataTable">[new DataTable]</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <Assign DisplayName="SytemException(nothing)_Assign" sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_2">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="s:Exception">[SystemException]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Config_Dictionary設定" DisplayName="Invoke InitAllSettings workflow" sap:VirtualizedContainerService.HintSize="484,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\InitAllConfigSetting.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_ConfigFile">C:\UipathRobot\WorkSpace\SCM01\Config.xlsm</InArgument>
                                    <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="out_Config">[Config]</OutArgument>
                                    <OutArgument x:TypeArguments="scg:List(x:String)" x:Key="out_QueueINameList">[QueuenameList]</OutArgument>
                                    <InArgument x:TypeArguments="s:String[]" x:Key="in_ConfigSheets">[{"Config檔設計","需查詢網站列表","Queue Item列表","收件人Email列表"}]</InArgument>
                                    <OutArgument x:TypeArguments="x:String" x:Key="out_SQLConnectionString">[SQLConnectionString]</OutArgument>
                                    <OutArgument x:TypeArguments="x:String" x:Key="out_RootTempFolder">[RootTempFolder]</OutArgument>
                                    <OutArgument x:TypeArguments="x:String" x:Key="out_RPATechnicalSupportEmail">[RPATechnicalSupportEmail]</OutArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:InvokeWorkflowFile>
                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplications workflow" sap:VirtualizedContainerService.HintSize="484,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                              </Sequence>
                            </TryCatch.Try>
                            <TryCatch.Catches>
                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="530,21" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ActivityAction x:TypeArguments="s:Exception">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                  </ActivityAction.Argument>
                                  <Assign DisplayName="SytemException is Exception_Assign" sap:VirtualizedContainerService.HintSize="263,60" sap2010:WorkflowViewState.IdRef="Assign_1">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="s:Exception">[SystemException]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="s:Exception">[Exception]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </ActivityAction>
                              </Catch>
                            </TryCatch.Catches>
                          </TryCatch>
                        </State.Entry>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">303.5,67.5</av:Point>
                            <av:Size x:Key="ShapeSize">253,125</av:Size>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <x:Double x:Key="StateContainerWidth">219</x:Double>
                            <x:Double x:Key="StateContainerHeight">88.519999999999982</x:Double>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <State.Transitions>
                          <Transition DisplayName="Config Successful" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_10">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <av:PointCollection x:Key="ConnectorLocation">430,192.5 430,247.5</av:PointCollection>
                                <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
                                <x:Int32 x:Key="DestConnectionPointIndex">38</x:Int32>
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Transition.To>
                              <x:Reference>__ReferenceID14</x:Reference>
                            </Transition.To>
                            <Transition.Action>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Trace" Message="[&quot;Cofig Succefully.Go to Transaction.&quot;]" />
                            </Transition.Action>
                            <Transition.Condition>
                              <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="SystemException is Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
                            </Transition.Condition>
                          </Transition>
                          <Transition DisplayName="ConfigFail" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_11">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <av:PointCollection x:Key="ConnectorLocation">303.5,111.25 73.1,111.25 73.1,272.5</av:PointCollection>
                                <x:Int32 x:Key="SrcConnectionPointIndex">25</x:Int32>
                                <x:Int32 x:Key="DestConnectionPointIndex">30</x:Int32>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Transition.To>
                              <State x:Name="__ReferenceID23" DisplayName="End Process" sap:VirtualizedContainerService.HintSize="169,95" sap2010:WorkflowViewState.IdRef="State_3" IsFinal="True">
                                <State.Entry>
                                  <Flowchart sap:VirtualizedContainerService.HintSize="648,712" sap2010:WorkflowViewState.IdRef="Flowchart_3">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <av:Point x:Key="ShapeLocation">280,2.5</av:Point>
                                        <av:Size x:Key="ShapeSize">60,75</av:Size>
                                        <av:PointCollection x:Key="ConnectorLocation">310,77.5 310,104.5</av:PointCollection>
                                        <x:Double x:Key="Width">614</x:Double>
                                        <x:Double x:Key="Height">676.5</x:Double>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Flowchart.StartNode>
                                      <x:Reference>__ReferenceID22</x:Reference>
                                    </Flowchart.StartNode>
                                    <FlowDecision x:Name="__ReferenceID21" Condition="[SystemException is Nothing]" DisplayName="System exception?" sap:VirtualizedContainerService.HintSize="111,87" sap2010:WorkflowViewState.IdRef="FlowDecision_8">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <av:Point x:Key="ShapeLocation">254.5,176.5</av:Point>
                                          <av:Size x:Key="ShapeSize">111,87</av:Size>
                                          <av:PointCollection x:Key="FalseConnector">365.5,220 480,220 480,261</av:PointCollection>
                                          <av:PointCollection x:Key="TrueConnector">254.5,220 230,220 230,336.5 290,336.5 290,366.5</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <FlowDecision.True>
                                        <FlowDecision x:Name="__ReferenceID17" Condition="[RunningWorklistTransaction is Nothing]" DisplayName="Carrier Found?" sap:VirtualizedContainerService.HintSize="88,87" sap2010:WorkflowViewState.IdRef="FlowDecision_7">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <av:Point x:Key="ShapeLocation">246,366.5</av:Point>
                                              <av:Size x:Key="ShapeSize">88,87</av:Size>
                                              <av:PointCollection x:Key="TrueConnector">246,410 200,410</av:PointCollection>
                                              <av:PointCollection x:Key="FalseConnector">334,410 359,410 359,506.5 299,506.5 299,536.5</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <FlowDecision.True>
                                            <FlowStep x:Name="__ReferenceID18">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">0,341</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,138</av:Size>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence sap2010:Annotation.AnnotationText="寄送運行結果&#xA;關閉chrome&#xA;設定本次運行Worklist Queueitem為Successful" DisplayName="Sent No Carrier need to run message" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="Sequence_114">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplication workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_93" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                                  <ui:InvokeWorkflowFile.Arguments>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:InvokeWorkflowFile.Arguments>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:InvokeWorkflowFile>
                                                <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" ReplyTo="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;Carrier no found, please check.Running Time :  &quot;+now.ToString(&quot;yyyy/MM/dd_HH:mm&quot;)]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendOutlookMail_5" Importance="Normal" IsBodyHtml="False" IsDraft="False" Sensitivity="Normal" Subject="[now.tostring(&quot;yyyy/MM/dd&quot;)+&quot;There is no Carrier on Worklist, please check.&quot;]" To="[RPATechnicalSupportEmail]">
                                                  <ui:SendOutlookMail.Files>
                                                    <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                  </ui:SendOutlookMail.Files>
                                                </ui:SendOutlookMail>
                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_63" Level="Warn" Message="[&quot;Process successfully, No Carrier is found.&quot;]" />
                                              </Sequence>
                                            </FlowStep>
                                          </FlowDecision.True>
                                          <FlowDecision.False>
                                            <FlowDecision x:Name="__ReferenceID19" Condition="[Runtime&gt;=3 and ErrorRowCounter&gt;0]" DisplayName="Retry failed?" sap:VirtualizedContainerService.HintSize="76,87" sap2010:WorkflowViewState.IdRef="FlowDecision_6">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <av:Point x:Key="ShapeLocation">242,536.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">76,87</av:Size>
                                                  <av:PointCollection x:Key="TrueConnector">242,580 200,580</av:PointCollection>
                                                  <av:PointCollection x:Key="FalseConnector">318,580 370,580</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <FlowDecision.True>
                                                <FlowStep x:Name="__ReferenceID16">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">0,503.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,153</av:Size>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Sequence sap2010:Annotation.AnnotationText="更新Data Base&#xA;寄送運行結果&#xA;關閉chrome&#xA;設定本次運行Worklist Queueitem為Fail" DisplayName="失敗_Retry 3次資料尚未抓全" sap:VirtualizedContainerService.HintSize="200,153" sap2010:WorkflowViewState.IdRef="Sequence_118">
                                                    <Sequence.Variables>
                                                      <Variable x:TypeArguments="x:String" Name="ZIPresultpath" />
                                                    </Sequence.Variables>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Sequence DisplayName="更新Data Base_Sequence" sap:VirtualizedContainerService.HintSize="444,274" sap2010:WorkflowViewState.IdRef="Sequence_116">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="TryCatch_20">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <TryCatch.Try>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="376,235" sap2010:WorkflowViewState.IdRef="Sequence_115">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="更新資料至DB" DisplayName="Invoke Insert_1_TableFromDTs workflow" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_94" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="DBProcess\Insert_1_TableFromDTs.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Insertdt">[WorkingDT]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationtoinDBTablename">[Config("CombinedListDBName").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="in_SQLConnectString">[SQLConnectionString]</InArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:InvokeWorkflowFile>
                                                          </Sequence>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_21">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_64" Level="Warn" Message="[&quot;Update Info to 3 Tables Fail. please check&quot;]" />
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_65" Level="Info" Message="[&quot;DELETE Used Info from Table&quot;+Config(&quot;CombinedListDBName&quot;).ToString]" />
                                                    </Sequence>
                                                    <Assign sap:VirtualizedContainerService.HintSize="444,60" sap2010:WorkflowViewState.IdRef="Assign_287">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:String">[ZIPresultpath]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:String">[RootTempFolder+WorkingCarrierName+"_"+now.ToString("yyyy.MM.dd.HH.mm")+".zip"]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <uascw:CompressFiles CompressedFileInfo="{x:Null}" Password="{x:Null}" CodePage="Default" CompressedFileName="[ZIPresultpath]" CompressionLevel="Normal" DisplayName="Compress/Zip Files" sap:VirtualizedContainerService.HintSize="444,213" sap2010:WorkflowViewState.IdRef="CompressFiles_2" OverrideExistingFile="True">
                                                      <uascw:CompressFiles.ContentToArchive>
                                                        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                                          <InArgument x:TypeArguments="x:String">[RunningTempfolder]</InArgument>
                                                        </scg:List>
                                                      </uascw:CompressFiles.ContentToArchive>
                                                    </uascw:CompressFiles>
                                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="444,91" sap2010:WorkflowViewState.IdRef="LogMessage_90" Level="Info" Message="[&quot;mail Receiver：&quot;+RPATechnicalSupportEmail]" />
                                                    <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" ReplyTo="{x:Null}" TimeoutMS="{x:Null}" Body="[WorkingCarrierName+&quot;資料抓取失敗，共更新&quot;+ WorkingDT.Rows.Count.ToString+&quot;筆資料，其中&quot;+ ErrorRowCounter.ToString+&quot;筆資料抓取失敗，請確認&quot;]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="444,145" sap2010:WorkflowViewState.IdRef="SendOutlookMail_6" Importance="Normal" IsBodyHtml="False" IsDraft="False" Sensitivity="Normal" Subject="[now.tostring(&quot;yyyy/MM/dd&quot;)+&quot;_Succrssful Runnning_from TWMCD_CargoTracking_Web data Extraction &quot;]" To="[RPATechnicalSupportEmail]">
                                                      <ui:SendOutlookMail.Files>
                                                        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                                          <InArgument x:TypeArguments="x:String">[ZIPresultpath]</InArgument>
                                                        </scg:List>
                                                      </ui:SendOutlookMail.Files>
                                                    </ui:SendOutlookMail>
                                                    <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status" ErrorType="Business" sap:VirtualizedContainerService.HintSize="444,79" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_8" Reason="Some data can't be extracted" Status="Failed" TransactionItem="[RunningWorklistTransaction]">
                                                      <ui:SetTransactionStatus.Analytics>
                                                        <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                      </ui:SetTransactionStatus.Analytics>
                                                      <ui:SetTransactionStatus.Output>
                                                        <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                      </ui:SetTransactionStatus.Output>
                                                    </ui:SetTransactionStatus>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplication workflow" sap:VirtualizedContainerService.HintSize="444,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_97" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="444,91" sap2010:WorkflowViewState.IdRef="LogMessage_66" Level="Trace" Message="[&quot;Process Ended. There are &quot; +ErrorRowCounter.ToString+&quot; can't be extracted.&quot;]" />
                                                  </Sequence>
                                                </FlowStep>
                                              </FlowDecision.True>
                                              <FlowDecision.False>
                                                <FlowStep x:Name="__ReferenceID20">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">370,503.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,153</av:Size>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Sequence sap2010:Annotation.AnnotationText="更新Data Base&#xA;寄送運行結果&#xA;關閉chrome&#xA;設定本次運行Worklist Queueitem為Successful" DisplayName="成功_資料抓取完成" sap:VirtualizedContainerService.HintSize="518,1518" sap2010:WorkflowViewState.IdRef="Sequence_122">
                                                    <Sequence.Variables>
                                                      <Variable x:TypeArguments="x:String" Name="Successzipath" />
                                                    </Sequence.Variables>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Sequence DisplayName="更新Data Base_Sequence" sap:VirtualizedContainerService.HintSize="476,414" sap2010:WorkflowViewState.IdRef="Sequence_120">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="434,322" sap2010:WorkflowViewState.IdRef="TryCatch_21">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <TryCatch.Try>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="376,235" sap2010:WorkflowViewState.IdRef="Sequence_119">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="更新資料至DB" DisplayName="Invoke Insert_1_TableFromDTs workflow" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_98" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="DBProcess\Insert_1_TableFromDTs.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Insertdt">[WorkingDT]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="in_DestinationtoinDBTablename">[Config("CombinedListDBName").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="in_SQLConnectString">[SQLConnectionString]</InArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:InvokeWorkflowFile>
                                                          </Sequence>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,160" sap2010:WorkflowViewState.IdRef="Catch`1_22">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_67" Level="Warn" Message="[&quot;Update Info to 3 Tables Fail. please check&quot;]" />
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                    </Sequence>
                                                    <Assign sap:VirtualizedContainerService.HintSize="476,60" sap2010:WorkflowViewState.IdRef="Assign_288">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:String">[Successzipath]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:String">[RootTempFolder+WorkingCarrierName+"_"+now.ToString("yyyy.MM.dd.HH.mm")+".zip"]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <uascw:CompressFiles CompressedFileInfo="{x:Null}" Password="{x:Null}" CodePage="Default" CompressedFileName="[Successzipath]" CompressionLevel="Normal" DisplayName="Compress/Zip Files" sap:VirtualizedContainerService.HintSize="476,213" sap2010:WorkflowViewState.IdRef="CompressFiles_3" OverrideExistingFile="True">
                                                      <uascw:CompressFiles.ContentToArchive>
                                                        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                                          <InArgument x:TypeArguments="x:String">[RunningTempfolder]</InArgument>
                                                        </scg:List>
                                                      </uascw:CompressFiles.ContentToArchive>
                                                    </uascw:CompressFiles>
                                                    <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" ReplyTo="{x:Null}" TimeoutMS="{x:Null}" Body="[WorkingCarrierName+&quot;資料抓取完成，共更新&quot;+ WorkingDT.Rows.Count.ToString+&quot;筆資料&quot;]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="476,145" sap2010:WorkflowViewState.IdRef="SendOutlookMail_7" Importance="Normal" IsBodyHtml="False" IsDraft="False" Sensitivity="Normal" Subject="[now.tostring(&quot;yyyy/MM/dd&quot;)+&quot;_Succrssful Runnning_from TWMCD_CargoTracking_Web data Extraction &quot;]" To="[RPATechnicalSupportEmail]">
                                                      <ui:SendOutlookMail.Files>
                                                        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                                          <InArgument x:TypeArguments="x:String">[Successzipath]</InArgument>
                                                        </scg:List>
                                                      </ui:SendOutlookMail.Files>
                                                    </ui:SendOutlookMail>
                                                    <ui:SetTransactionStatus ContinueOnError="{x:Null}" Reason="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status" ErrorType="Business" sap:VirtualizedContainerService.HintSize="476,79" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_9" Status="Successful" TransactionItem="[RunningWorklistTransaction]">
                                                      <ui:SetTransactionStatus.Analytics>
                                                        <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                      </ui:SetTransactionStatus.Analytics>
                                                      <ui:SetTransactionStatus.Output>
                                                        <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                      </ui:SetTransactionStatus.Output>
                                                    </ui:SetTransactionStatus>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplication workflow" sap:VirtualizedContainerService.HintSize="476,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_101" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="476,91" sap2010:WorkflowViewState.IdRef="LogMessage_68" Level="Info" Message="[&quot;Process successfully&quot;]" />
                                                  </Sequence>
                                                </FlowStep>
                                              </FlowDecision.False>
                                            </FlowDecision>
                                          </FlowDecision.False>
                                        </FlowDecision>
                                      </FlowDecision.True>
                                      <FlowDecision.False>
                                        <FlowStep x:Name="__ReferenceID15">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">380,261</av:Point>
                                              <av:Size x:Key="ShapeSize">200,138</av:Size>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Sequence sap2010:Annotation.AnnotationText="寄送運行結果&#xA;關閉chrome&#xA;設定本次運行Worklist Queueitem為Fail" DisplayName="Sent SytemExceptioin Message" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="Sequence_124">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" ReplyTo="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;於抓取 ： &quot;+  WorkingCarrierName+&quot; 資料時出現系統錯誤，煩請相關IT與技術人員進行排查，謝謝，運行時間：&quot;+now.ToString(&quot;yyyy/MM/dd_HH:mm&quot;)]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="484,145" sap2010:WorkflowViewState.IdRef="SendOutlookMail_8" Importance="Normal" IsBodyHtml="False" IsDraft="False" Sensitivity="Normal" Subject="[now.tostring(&quot;yyyy/MM/dd&quot;)+&quot;_Error : SytemException_from TWMCD_CargoTracking_Web data Extraction &quot;]" To="[RPATechnicalSupportEmail]">
                                              <ui:SendOutlookMail.Files>
                                                <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                              </ui:SendOutlookMail.Files>
                                            </ui:SendOutlookMail>
                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="True" DisplayName="Invoke CloseAllApplication workflow" sap:VirtualizedContainerService.HintSize="484,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_102" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="Framework\CloseAllApplication.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                            <If Condition="[not WorkingCarrierName is Nothing]" sap:VirtualizedContainerService.HintSize="484,256" sap2010:WorkflowViewState.IdRef="If_27">
                                              <If.Then>
                                                <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status" ErrorType="Business" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_10" Reason="SytemException occured" Status="Failed" TransactionItem="[RunningWorklistTransaction]">
                                                  <ui:SetTransactionStatus.Analytics>
                                                    <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                  </ui:SetTransactionStatus.Analytics>
                                                  <ui:SetTransactionStatus.Output>
                                                    <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                                  </ui:SetTransactionStatus.Output>
                                                </ui:SetTransactionStatus>
                                              </If.Then>
                                            </If>
                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="484,91" sap2010:WorkflowViewState.IdRef="LogMessage_69" Level="Warn" Message="[&quot;Process Failed,  because of system exception, please check&quot;]" />
                                          </Sequence>
                                        </FlowStep>
                                      </FlowDecision.False>
                                    </FlowDecision>
                                    <x:Reference>__ReferenceID15</x:Reference>
                                    <x:Reference>__ReferenceID16</x:Reference>
                                    <x:Reference>__ReferenceID17</x:Reference>
                                    <x:Reference>__ReferenceID18</x:Reference>
                                    <x:Reference>__ReferenceID19</x:Reference>
                                    <x:Reference>__ReferenceID20</x:Reference>
                                    <FlowStep x:Name="__ReferenceID22">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">210,104.5</av:Point>
                                          <av:Size x:Key="ShapeSize">200,51</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">310,155.5 310,176.5</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="LogMessage_87" Level="Info" Message="[&quot;RPATechnicalSupportEmail收件人：&quot;+RPATechnicalSupportEmail]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:LogMessage>
                                      <FlowStep.Next>
                                        <x:Reference>__ReferenceID21</x:Reference>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </Flowchart>
                                </State.Entry>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">5.5,272.5</av:Point>
                                    <av:Size x:Key="ShapeSize">169,95</av:Size>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Double x:Key="StateContainerWidth">135</x:Double>
                                    <x:Double x:Key="StateContainerHeight">58.519999999999982</x:Double>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </State>
                            </Transition.To>
                            <Transition.Action>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Warn" Message="[&quot;SytemException Happened,Cofig fail.Go to End Process.&quot;]" />
                            </Transition.Action>
                            <Transition.Condition>[SystemException isnot Nothing]</Transition.Condition>
                          </Transition>
                        </State.Transitions>
                      </State>
                    </Transition.To>
                    <Transition.Action>
                      <ui:LogMessage DisplayName="SystemException occured_Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Warn" Message="[&quot;SystemException occured, Restart from Config,Runtime：&quot; +Runtime.ToString]" />
                    </Transition.Action>
                    <Transition.Condition>
                      <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="SystemException isnot Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
                    </Transition.Condition>
                  </Transition>
                  <Transition DisplayName="Successful Running" sap:VirtualizedContainerService.HintSize="451,505" sap2010:WorkflowViewState.IdRef="Transition_12">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:PointCollection x:Key="ConnectorLocation">303.5,527.5 81.55,527.5 81.55,367.5</av:PointCollection>
                        <x:Int32 x:Key="SrcConnectionPointIndex">61</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">35</x:Int32>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <x:Reference>__ReferenceID23</x:Reference>
                    </Transition.To>
                    <Transition.Action>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_9" Level="Trace" Message="[&quot;Runtime第&quot;+ (Runtime-1).ToString+&quot;運行完成，進入End Process&quot;]" />
                    </Transition.Action>
                    <Transition.Condition>
                      <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="BusinessException is Nothing and SystemException is Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_2" />
                    </Transition.Condition>
                  </Transition>
                </State.Transitions>
                <State.Variables>
                  <Variable x:TypeArguments="scg:List(x:String)" Name="PortNameMappingDatatablelist" />
                </State.Variables>
              </State>
            </Transition.To>
            <Transition.Action>
              <Sequence sap:VirtualizedContainerService.HintSize="376,183" sap2010:WorkflowViewState.IdRef="Sequence_59">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_3" Level="Trace" Message="[&quot;Get&quot;+ WorkingCarrierName+&quot; Transactionitems,Go Processing&quot;]" />
              </Sequence>
            </Transition.Action>
            <Transition.Condition>
              <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="BusinessException isnot Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_2" />
            </Transition.Condition>
          </Transition>
          <Transition DisplayName="GO End process" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_9">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">303.5,310 273.5,310 273.5,320 174.5,320</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">37</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">36</x:Int32>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <x:Reference>__ReferenceID23</x:Reference>
            </Transition.To>
            <Transition.Action>
              <ui:LogMessage DisplayName="RetryDT運行完畢，準備結束流程_Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Trace" Message="[&quot;From Transaction_Go End Process&quot;]" />
            </Transition.Action>
            <Transition.Condition>
              <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="BusinessException is Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
            </Transition.Condition>
          </Transition>
          <Transition DisplayName="System Exception" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_14">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">303.5,353.75 273.5,353.75 273.5,353.25 174.5,353.25</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">65</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">64</x:Int32>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <x:Reference>__ReferenceID23</x:Reference>
            </Transition.To>
            <Transition.Action>
              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_11" Level="Warn" Message="[&quot;From Transaction_System exception Occured, please check&quot;]" />
            </Transition.Action>
            <Transition.Condition>[SystemException isnot Nothing]</Transition.Condition>
          </Transition>
        </State.Transitions>
      </State>
      <x:Reference>__ReferenceID23</x:Reference>
      <x:Reference>__ReferenceID24</x:Reference>
      <x:Reference>__ReferenceID25</x:Reference>
    </StateMachine>
  </Sequence>
</Activity>